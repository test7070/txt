z_cuwp3:--z_cuwp3
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [1] then '' else [1] end
set @t_edate = case when '#non' = [2] then char(255) else [2] end 
set @t_bstationno = case when '#non' = [3] then '' else [3] end
set @t_estationno = case when '#non' = [4] then char(255) else [4] end
--************************************************************************************
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END

create table #tmp (
	stationno nvarchar(50),
	station nvarchar(50),
	title nvarchar(50),
	days01 decimal(18,3),days02 decimal(18,3),days03 decimal(18,3),days04 decimal(18,3),days05 decimal(18,3),days06 decimal(18,3),days07 decimal(18,3),days08 decimal(18,3),
	days09 decimal(18,3),days10 decimal(18,3),days11 decimal(18,3),days12 decimal(18,3),days13 decimal(18,3),days14 decimal(18,3),days15 decimal(18,3),days16 decimal(18,3),
	days17 decimal(18,3),days18 decimal(18,3),days19 decimal(18,3),days20 decimal(18,3),days21 decimal(18,3),days22 decimal(18,3),days23 decimal(18,3),days24 decimal(18,3),
	days25 decimal(18,3),days26 decimal(18,3),days27 decimal(18,3),days28 decimal(18,3),days29 decimal(18,3),days30 decimal(18,3),days31 decimal(18,3),total float
)

declare @tdate nvarchar(10)=@t_bdate
declare @field nvarchar(20)
declare @counts int=0
declare @stationno nvarchar(90)
declare @station nvarchar(90)
declare @hours float
declare @mount float

declare cursor_table cursor for
select noa,station,hours,mount from station where noa between @t_bstationno and @t_estationno
open cursor_table
fetch next from cursor_table
into @stationno,@station,@hours,@mount
while(@@FETCH_STATUS <> -1)
begin
	
	--排產
	insert #tmp
	select @stationno,@station,'1',
	null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
	null,null,null,null,null,null,null,null,null,null,null,0
	
	--編制機時
	insert #tmp
	select @stationno,@station,'2',
	null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
	null,null,null,null,null,null,null,null,null,null,null,0
	
	--編制人時
	insert #tmp
	select @stationno,@station,'3',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	
	--標準日機時
	insert #tmp
	select @stationno,@station,'4',
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),
	isnull(@hours*@mount,0),isnull(@hours*@mount,0),isnull(@hours*@mount,0),0
	
	--編製人數
	insert #tmp
	select @stationno,@station,'5',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	
	--出勤人數
	insert #tmp
	select @stationno,@station,'6',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	
	
	set @tdate=@t_bdate
	set @counts=1
	while(@tdate<=@t_edate and @counts<32)
	begin
		if((select COUNT(*) from view_cug a left join view_cugs b on a.noa=b.noa where a.stationno=@stationno and b.cuadate>=@tdate)>0
			or (select COUNT(*) from view_cugt where stationno=@stationno and datea>=@tdate)>0
			or (select COUNT(*) from cuy where stationno=@stationno and bdate>=@tdate)>0 
			or (select COUNT(*) from cux where stationno=@stationno and bdate>=@tdate)>0 
			or (select COUNT(*) from view_cuw where stationno=@stationno and datea>=@tdate)>0 
		)
		begin
			set @field=right('00'+cast(@counts as nvarchar(2)),2)
			--排產
			exec('update #tmp set days'+@field+'=(select sum(b.hours) from view_cug a left join view_cugs b on a.noa=b.noa where a.stationno='''+@stationno+''' and b.cuadate='''+@tdate+''')
			where title=''1'' and stationno='''+@stationno+'''')
			--編制機時
			exec('update #tmp set days'+@field+'=(select sum(gen) from view_cugt where stationno='''+@stationno+''' and datea='''+@tdate+''')
			where title=''2'' and stationno='''+@stationno+'''')
			--編制人時
			exec('update #tmp set days'+@field+'=isnull((select sum((b.hours+b.addhours)/60) from cuy a left join cuys b on a.noa=b.noa where a.stationno='''+@stationno+''' and bdate='''+@tdate+'''),0)
			+isnull((select sum((b.hours+b.addhours)/60) from cux a left join cuxs b on a.noa=b.noa where a.stationno='''+@stationno+''' and bdate='''+@tdate+'''),0)
			where title=''3'' and stationno='''+@stationno+'''')
			--編製人數
			exec('update #tmp set days'+@field+'=isnull((select MAX(b.mans) from cuy a left join cuys b on a.noa=b.noa where a.stationno='''+@stationno+''' and bdate='''+@tdate+'''),0)
			+isnull((select MAX(b.managermans) from cux a left join cuxs b on a.noa=b.noa where a.stationno='''+@stationno+''' and bdate='''+@tdate+'''),0)
			where title=''5'' and stationno='''+@stationno+'''')
			--編製人數
			exec('update #tmp set days'+@field+'=isnull((select MAX(b.mans) from view_cuw a left join view_cuwt b on a.noa=b.noa where a.stationno='''+@stationno+''' and datea='''+@tdate+'''),0)
			where title=''6'' and stationno='''+@stationno+'''')
		end
		else
		begin
			break
		end
		
		set @tdate = dbo.q_cdn(@tdate,1)
		set @counts=@counts+1
	end
	
	fetch next from cursor_table
	into @stationno,@station,@hours,@mount
end
close cursor_table
deallocate cursor_table

update #tmp
set total=ISNULL(days01,0)+ISNULL(days02,0)+ISNULL(days03,0)+ISNULL(days04,0)+ISNULL(days05,0)+ISNULL(days06,0)+ISNULL(days07,0)+ISNULL(days08,0)+ISNULL(days09,0)+ISNULL(days10,0)
+ISNULL(days11,0)+ISNULL(days12,0)+ISNULL(days13,0)+ISNULL(days14,0)+ISNULL(days15,0)+ISNULL(days16,0)+ISNULL(days17,0)+ISNULL(days18,0)+ISNULL(days19,0)+ISNULL(days20,0)
+ISNULL(days21,0)+ISNULL(days22,0)+ISNULL(days23,0)+ISNULL(days24,0)+ISNULL(days25,0)+ISNULL(days26,0)+ISNULL(days27,0)+ISNULL(days28,0)+ISNULL(days29,0)+ISNULL(days30,0)
+ISNULL(days31,0)
where title!='4'

delete a from #tmp a 
outer apply (select SUM(isnull(total,0))xtotal from #tmp where stationno=a.stationno)b
where b.xtotal=0

--總計
insert #tmp
select CHAR(255),CHAR(255),title
,SUM(days01),SUM(days02),SUM(days03),SUM(days04),SUM(days05),SUM(days06),SUM(days07),SUM(days08),SUM(days09),SUM(days10)
,SUM(days11),SUM(days12),SUM(days13),SUM(days14),SUM(days15),SUM(days16),SUM(days17),SUM(days18),SUM(days19),SUM(days20)
,SUM(days21),SUM(days22),SUM(days23),SUM(days24),SUM(days25),SUM(days26),SUM(days27),SUM(days28),SUM(days29),SUM(days30),SUM(days31)
,SUM(ISNULL(days01,0)+ISNULL(days02,0)+ISNULL(days03,0)+ISNULL(days04,0)+ISNULL(days05,0)+ISNULL(days06,0)+ISNULL(days07,0)+ISNULL(days08,0)+ISNULL(days09,0)+ISNULL(days10,0)
+ISNULL(days11,0)+ISNULL(days12,0)+ISNULL(days13,0)+ISNULL(days14,0)+ISNULL(days15,0)+ISNULL(days16,0)+ISNULL(days17,0)+ISNULL(days18,0)+ISNULL(days19,0)+ISNULL(days20,0)
+ISNULL(days21,0)+ISNULL(days22,0)+ISNULL(days23,0)+ISNULL(days24,0)+ISNULL(days25,0)+ISNULL(days26,0)+ISNULL(days27,0)+ISNULL(days28,0)+ISNULL(days29,0)+ISNULL(days30,0)
+ISNULL(days31,0))
from #tmp group by title

--預估直接人工
declare @salary float=isnull((select SUM(total5) from salary where mon=left(@t_bdate,LEN(@t_bdate)-3)),0)
declare @cuwcount float=isnull((select count(*) from (select datea from view_cuw where left(datea,LEN(@t_bdate)-3)=left(@t_bdate,LEN(@t_bdate)-3) group by datea)tmp),0)
declare @scost float=case when @cuwcount=0 then 0 else round(@salary/@cuwcount,3) end
declare @cmd nvarchar(max)
declare @tscost float=0

set @salary=isnull((select SUM(total5) from salary where mon=left(@t_edate,LEN(@t_edate)-3)),0)
set @cuwcount=isnull((select count(*) from (select datea from view_cuw where left(datea,LEN(@t_edate)-3)=left(@t_edate,LEN(@t_edate)-3) group by datea)tmp),0)
declare @yscost float=case when @cuwcount=0 then 0 else round(@salary/@cuwcount,3) end 

insert #tmp (stationno,station,title)
select CHAR(255),CHAR(255),'7'

set @tdate=@t_bdate
set @counts=1

while(@tdate<=@t_edate and @counts<32)
begin
	set @field=right('00'+cast(@counts as nvarchar(2)),2)
	if((select count(*) from view_cuw where datea=@tdate)>0) --判斷是否是報工日
	begin
		
		if(left(@tdate,LEN(@t_edate)-3)=left(@t_edate,LEN(@t_edate)-3))
		begin	
			set @cmd='update #tmp set days'+@field+'=isnull(@yscost,0) where title=''7'' '
			execute sp_executesql @cmd,N'@yscost float',@yscost=@yscost
			
			set @tscost=@tscost+@yscost
		end
		else 
		begin
			set @cmd='update #tmp set days'+@field+'=isnull(@scost,0) where title=''7'' '
			execute sp_executesql @cmd,N'@scost float',@scost=@scost
			
			set @tscost=@tscost+@scost
		end
	end
	else
	begin
		set @cmd='update #tmp set days'+@field+'=0 where title=''7'' '
		execute sp_executesql @cmd
	end
	
	set @tdate = dbo.q_cdn(@tdate,1)
	set @counts=@counts+1
end

insert #tmp
select CHAR(255),CHAR(255),'8'
,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost
,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost
,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost,@tscost

select * 
from #tmp order by stationno,title

IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END;
--------------------------------------------------------------------------------------------------------------------------------
z_cuwp2:--z_cuwp2
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [1] then '' else [1] end
set @t_edate = case when '#non' = [2] then char(255) else [2] end 
set @t_bstationno = case when '#non' = [3] then '' else [3] end
set @t_estationno = case when '#non' = [4] then char(255) else [4] end 
declare @tmp table(
	gno nvarchar(10),
	stationno nvarchar(50),
	station nvarchar(max),
	gen decimal(18,3),
	hours decimal(18,3),
	workhours decimal(18,3),
	workmount decimal(18,3),
	mount decimal(18,3),
	addwork decimal(18,3),
	addmount decimal(18,3),
	addhours decimal(18,3),
	chgtime decimal(18,3),
	faulttime decimal(18,3),
	delaytime decimal(18,3),
	waittime decimal(18,3),
	waitfedtime decimal(18,3),
	lacksss decimal(18,3),
	mans decimal(18,3),
	supmans decimal(18,3),
	managermans decimal(18,3)
)
insert into @tmp
	select
		'0' gno,a.stationno,d.station,isnull(d.gen,0),b.hours,c.workhours,b.workmount,b.mount,
		b.addwork,b.addmount,b.addhours,b.chgtime,b.faulttime,b.delaytime,b.waittime,b.waitfedtime,b.lacksss,
		c.mans,c.supmans,c.managermans
	from view_cuw a
	left join(
		select
			noa,sum(borntime) hours,
			sum(case when isovertime!=1 then workmount else 0 end) workmount,sum(mount) mount,
			sum(case when isovertime=1 then workmount else 0 end) addwork,
			sum(case when isovertime=1 then mount else 0 end) addmount,sum(addtime) addhours,
			sum(chgtime) chgtime,sum(faulttime) faulttime,sum(delaytime) delaytime,sum(waittime) waittime,
			sum(waitfedtime) waitfedtime,sum(lacksss) lacksss
		from view_cuws
		group by noa
	) b on (a.noa=b.noa)
	left join(
		select
			noa,sum(mans) mans,sum(supmans) supmans,sum(managermans) managermans,
			sum(hours+addhours) workhours
		from view_cuwt
		group by noa
	) c on (a.noa=c.noa)
	left join station d on (a.stationno=d.noa)
	where (a.datea between @t_bdate and @t_edate) and
			 (a.stationno between @t_bstationno and @t_estationno)
select
	a.gno,a.stationno,a.station,a.gen,a.hours,a.workhours,a.workmount,a.mount,a.addwork,
	a.addmount,a.addhours,a.chgtime,a.faulttime,a.delaytime,a.waittime,a.waitfedtime,a.lacksss,
	a.mans,a.supmans,a.managermans
from @tmp a
order by a.stationno;

/*
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END
IF OBJECT_ID('tempdb..#tmpa')is not null
BEGIN
	drop table #tmpa
END
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [1] then '102/01/01' else [1] end
set @t_edate = case when '#non' = [2] then '102/01/31' else [2] end 
set @t_bstationno = case when '#non' = [3] then '' else [3] end
set @t_estationno = case when '#non' = [4] then char(255) else [4] end 

create table #tmp (
	gno nvarchar(3),
	idno int identity(0,1),
	title nvarchar(50),
	days01 nvarchar(30),
	days02 nvarchar(30),
	days03 nvarchar(30),
	days04 nvarchar(30),
	days05 nvarchar(30),
	days06 nvarchar(30),
	days07 nvarchar(30),
	days08 nvarchar(30),
	days09 nvarchar(30),
	days10 nvarchar(30),
	days11 nvarchar(30),
	days12 nvarchar(30),
	days13 nvarchar(30),
	days14 nvarchar(30),
	days15 nvarchar(30),
	days16 nvarchar(30),
	days17 nvarchar(30),
	days18 nvarchar(30),
	days19 nvarchar(30),
	days20 nvarchar(30),
	days21 nvarchar(30),
	days22 nvarchar(30),
	days23 nvarchar(30),
	days24 nvarchar(30),
	days25 nvarchar(30),
	days26 nvarchar(30),
	days27 nvarchar(30),
	days28 nvarchar(30),
	days29 nvarchar(30),
	days30 nvarchar(30),
	days31 nvarchar(30)
)
create table #tmpa(
	gno nvarchar(1),
	datea nvarchar(10),
	gen float,
	hours float,
	ovewtime float,
	workmount float,
	mount float,
	isovertime int
)
insert into #tmpa
	select
		'0',b.datea,c.gen,a.borntime,a.addtime,a.workmount,a.mount,a.isovertime
	from view_cuws a
	left join view_cuw b on a.noa = b.noa
	left join station c on b.stationno=c.noa
	where (b.stationno between @t_bstationno and @t_estationno)
declare @cmd nvarchar(max)
declare @Field nvarchar(max)
declare @Field_no nvarchar(10)
declare @sql_str_idno0 nvarchar(max)
declare @sql_str_idno1 nvarchar(max)
declare @sql_str_idno2 nvarchar(max)
declare @sql_str_idno3 nvarchar(max)
declare @sql_str_idno4 nvarchar(max)
declare @sql_str_idno5 nvarchar(max)
declare @sql_str_idno6 nvarchar(max)
declare @sql_str_idno7 nvarchar(max)
declare @sql_str_idno8 nvarchar(max)
declare @sql_str_idno9 nvarchar(max)
declare @sql_str_idno10 nvarchar(max)
declare @sql_str_idno11 nvarchar(max)
declare @sql_str_idno12 nvarchar(max)
declare @sql_str_idno13 nvarchar(max)
declare @sql_str_idno14 nvarchar(max)
declare @sql_str_idno15 nvarchar(max)
declare @alter_format nvarchar(max)
declare @alter_zero2empty nvarchar(max)
declare @i int
set @Field = ''
set @Field_no = ''
set @sql_str_idno0 = 'select 0,''日期'','
set @sql_str_idno1 = 'select 0,''基本產能'','
set @sql_str_idno2 = 'select 0,''工時'','
set @sql_str_idno3 = 'select 0,''工時累計'','
set @sql_str_idno4 = 'select 0,''製令工時'','
set @sql_str_idno5 = 'select 0,''製令工時累計'','
set @sql_str_idno6 = 'select 0,''製令數'','
set @sql_str_idno7 = 'select 0,''製令數累計'','
set @sql_str_idno8 = 'select 0,''完工數量'','
set @sql_str_idno9 = 'select 0,''完工數量累計'','
set @sql_str_idno10 = 'select 0,''加班製令數'','
set @sql_str_idno11 = 'select 0,''加班製令數累計'','
set @sql_str_idno12 = 'select 0,''加班產量'','
set @sql_str_idno13 = 'select 0,''加班產量累計'','
set @sql_str_idno14 = 'select 0,''加班時數'','
set @sql_str_idno15 = 'select 0,''加班累計'','
set @alter_format = 'update #tmp set'
set @alter_zero2empty = ''
set @i = 1
while(@i < 32)
begin
	set @Field_no = RIGHT(REPLICATE('0', 2) + CAST(@i as NVARCHAR), 2)
	set @Field += 'days' + @Field_no + ','
	set @sql_str_idno0 += '''' +  left(@t_bdate,7) + @Field_no + ''','
	set @sql_str_idno1 += '(select sum(isnull(gen,0)) from #tmpa where datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno2 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno3 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno4 += '0,'
	set @sql_str_idno5 += '0,'
	set @sql_str_idno6 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno7 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno8 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno9 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno10 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno11 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno12 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno13 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno14 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno15 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @alter_format += ' days' + @Field_no + ' = 	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(cast(days' + @Field_no + ' as float),0)),1)),4,12)), '
	set @alter_zero2empty += 'update #tmp set days' + @Field_no + ' = '''' where idno != 0 and days' + @Field_no + ' =''0'' '
	set @i += 1
end
begin ------idno=0
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno0,0,len(@sql_str_idno0))
	exec(@cmd)
end
begin ------idno=1
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno1,0,len(@sql_str_idno1))
	exec(@cmd)
end
begin ------idno=2
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno2,0,len(@sql_str_idno2))
	exec(@cmd)
end
begin ------idno=3
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno3,0,len(@sql_str_idno3))
	exec(@cmd)
end
begin ------idno=4
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno4,0,len(@sql_str_idno4))
	exec(@cmd)
end
begin ------idno=5
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno5,0,len(@sql_str_idno5))
	exec(@cmd)
end
begin ------idno=6
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno6,0,len(@sql_str_idno6))
	exec(@cmd)
end
begin ------idno=7
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno7,0,len(@sql_str_idno7))
	exec(@cmd)
end
begin ------idno=8
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno8,0,len(@sql_str_idno8))
	exec(@cmd)
end
begin ------idno=9
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno9,0,len(@sql_str_idno9))
	exec(@cmd)
end
begin ------idno=10
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno10,0,len(@sql_str_idno10))
	exec(@cmd)
end
begin ------idno=11
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno11,0,len(@sql_str_idno11))
	exec(@cmd)
end
begin ------idno=12
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno12,0,len(@sql_str_idno12))
	exec(@cmd)
end
begin ------idno=13
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno13,0,len(@sql_str_idno13))
	exec(@cmd)
end
begin ------idno=14
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno14,0,len(@sql_str_idno14))
	exec(@cmd)
end
begin ------idno=15
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno15,0,len(@sql_str_idno15))
	exec(@cmd)
end
begin ------修改數字格式
	set @cmd = substring(@alter_format,0,len(@alter_format)) + ' where idno != 0'
	exec(@cmd)
end
begin ------為0則清空
	set @cmd = @alter_zero2empty
	exec(@cmd)
end
------取某月最後一天
declare @lastDay nvarchar(10)
set @lastDay = cast((cast(left(@t_bdate,3) as int) + 1911) as nvarchar) + substring(@t_bdate,4,3) + '/01'
set @lastDay = right(CONVERT(nvarchar(10),DATEADD(ss, -1, DATEADD(m,1,@lastDay)),111),2)+1
------取某月最後一天
while(cast(@lastDay as int) < 32 )
begin
	set @cmd = 'update #tmp set days' + @lastDay + '= '''''
	exec(@cmd)
	set @lastDay = cast((cast(@lastDay as int)+1) as nvarchar)
end
update #tmp set gno = idno
select * from #tmp
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END
IF OBJECT_ID('tempdb..#tmpa')is not null
BEGIN
	drop table #tmpa
END;
---------------------------------------------------------------------*
z_cuwp2:--z_cuwp2
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
       drop table #tmp
END
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [1] then '102/01/01' else [1] end
set @t_edate = case when '#non' = [2] then '102/01/31' else [2] end 
set @t_bstationno = case when '#non' = [3] then '' else [3] end
set @t_estationno = case when '#non' = [4] then char(255) else [4] end 
 
create table #tmp (
	gno nvarchar(3),
	idno int identity(0,1),
	title nvarchar(50),
	station0 nvarchar(90),
	station1 nvarchar(90),
	station2 nvarchar(90),
	station3 nvarchar(90),
	station4 nvarchar(90),
	station5 nvarchar(90),
	station6 nvarchar(90),
	station7 nvarchar(90),
	station8 nvarchar(90),
	station9 nvarchar(90),
	station_a nvarchar(90),
	station_b nvarchar(90),
	station_c nvarchar(90),
	station_d nvarchar(90),
	station_e nvarchar(90),
	station_f nvarchar(90),
	station_g nvarchar(90),
	station_h nvarchar(90),
	station_i nvarchar(90)
)
declare @station_title nvarchar(max)
declare @cmd nvarchar(max)
declare @i int
set @i = 0
set @station_title =  '''工作中心編號''' + ','
set @cmd = ''
declare @station nvarchar(90)
declare cursor_table cursor for
select top 19 noa from  station
open cursor_table
fetch next from cursor_table
into @station
while(@@FETCH_STATUS <> -1)
begin
	set @station_title += '''' + @station + '''' + ',' 
	set @i +=1
	fetch next from cursor_table
	into @station
end
close cursor_table
deallocate cursor_table
while(@i < (18 + 1))
begin
	set @station_title += '''''' + ','
	set @i += 1
end
set @station_title = '0,' + @station_title
if(right(@station_title,1) = ',')
	set @station_title = substring(@station_title,0,len(@station_title))
set @cmd = 'select '  + @station_title
insert into #tmp ------idno=0
	exec(@cmd)
declare @tmp table(
	gno nvarchar(1),
	stationno nvarchar(30),
	station nvarchar(90),
	gen float,
	borntime float,
	addtime float,
	chgtime float,
	faulttime float,
	delaytime float,
	waittime float,
	waitfedtime float,
	lacksss float,
	workmount float,
	mount float,
	mans float,
	supmans float,
	isovertime int
)
insert into @tmp
	select
		'0',a.stationno,a.station,d.gen,b.borntime,b.addtime,b.chgtime,b.faulttime,
		b.delaytime,b.waittime,b.waitfedtime,b.lacksss,b.workmount,
		b.mount,c.mans,c.supmans,b.isovertime
	from view_cuw a
	left join view_cuws b on a.noa = b.noa
	outer apply(select SUM(mans) mans,SUM(supmans) supmans from view_cuwt where noa=a.noa) c
	left join station d on a.stationno=d.noa
	where (a.datea between @t_bdate and @t_edate) and
		  (isnull(a.stationno,'') != '') and
		  (a.stationno between @t_bstationno and @t_estationno)
insert into #tmp ------基本產能 idno=1
	select 0,'基本產能'
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------工時 idno=2
	select 0,'工時'
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令工時 idno=3
	select 0,'製令工時'
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令工時累計 idno=4
	select 0,'製令工時累計	'
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------製令數 idno=5
	select 0,'製令數'
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令數累計 idno=6
	select 0,'製令數累計'
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------完工數量 idno=7
	select 0,'完工數量'
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------完工數量累計 idno=8
	select 0,'完工數量累計'
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班製令數 idno=9
	select 0,'加班製令數'
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班製令數累計 idno=10
	select 0,'加班製令數累計'
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班產量 idno=11
	select 0,'加班產量'
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班產量累計 idno=12
	select 0,'加班產量累計'
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班時數 idno=13
	select 0,'加班時數'
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班累計 idno=14
	select 0,'加班累計'
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------換膜 idno=15
	select 0,'換膜'
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------換膜累計 idno=16
	select 0,'換膜累計'
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------故障 idno=17
	select 0,'故障'
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------故障累計 idno=18
	select 0,'故障累計'
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------延遲 idno=19
	select 0,'延遲'
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------延遲累計 idno=20
	select 0,'延遲累計'
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------待單 idno=21
	select 0,'待單'
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------待單累計 idno=22
	select 0,'待單累計'
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------待料 idno=23
	select 0,'待料'
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------待料累計 idno=24
	select 0,'待料累計'
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------缺員 idno=25
	select 0,'缺員'
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------缺員累計 idno=26
	select 0,'缺員累計'
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------人員編制 idno=27
	select 0,'人員編制'
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------人員支援 idno=28
	select 0,'人員支援'
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------人員間接 idno=29
	select 0,'人員間接'
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0

update #tmp set gno = idno
-------修改數字格式
update #tmp set station0 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station0,0)),1)),4,12)) where idno != 0
update #tmp set station1 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station1,0)),1)),4,12)) where idno != 0
update #tmp set station2 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station2,0)),1)),4,12)) where idno != 0
update #tmp set station3 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station3,0)),1)),4,12)) where idno != 0
update #tmp set station4 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station4,0)),1)),4,12)) where idno != 0
update #tmp set station5 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station5,0)),1)),4,12)) where idno != 0
update #tmp set station6 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station6,0)),1)),4,12)) where idno != 0
update #tmp set station7 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station7,0)),1)),4,12)) where idno != 0
update #tmp set station8 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station8,0)),1)),4,12)) where idno != 0
update #tmp set station9 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station9,0)),1)),4,12)) where idno != 0
update #tmp set station_a = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_a,0)),1)),4,12)) where idno != 0
update #tmp set station_b = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_b,0)),1)),4,12)) where idno != 0
update #tmp set station_c = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_c,0)),1)),4,12)) where idno != 0
update #tmp set station_d = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_d,0)),1)),4,12)) where idno != 0
update #tmp set station_e = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_e,0)),1)),4,12)) where idno != 0
update #tmp set station_f = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_f,0)),1)),4,12)) where idno != 0
update #tmp set station_g = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_g,0)),1)),4,12)) where idno != 0
update #tmp set station_h = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_h,0)),1)),4,12)) where idno != 0
update #tmp set station_i = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_i,0)),1)),4,12)) where idno != 0
-------為0則清空
update #tmp set station0 = '' where idno != 0 and station0 <=0 and idno <33
update #tmp set station1 = '' where idno != 0 and station1 <=0 and idno <33
update #tmp set station2 = '' where idno != 0 and station2 <=0 and idno <33
update #tmp set station3 = '' where idno != 0 and station3 <=0
update #tmp set station4 = '' where idno != 0 and station4 <=0
update #tmp set station5 = '' where idno != 0 and station5 <=0
update #tmp set station6 = '' where idno != 0 and station6 <=0
update #tmp set station7 = '' where idno != 0 and station7 <=0
update #tmp set station8 = '' where idno != 0 and station8 <=0
update #tmp set station9 = '' where idno != 0 and station9 <=0
update #tmp set station_a = '' where idno != 0 and station_a <=0
update #tmp set station_b = '' where idno != 0 and station_b <=0
update #tmp set station_c = '' where idno != 0 and station_c <=0
update #tmp set station_d = '' where idno != 0 and station_d <=0
update #tmp set station_e = '' where idno != 0 and station_e <=0
update #tmp set station_f = '' where idno != 0 and station_f <=0
update #tmp set station_g = '' where idno != 0 and station_g <=0
update #tmp set station_h = '' where idno != 0 and station_h <=0
update #tmp set station_i = '' where idno != 0 and station_i <=0
select * from #tmp
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
       drop table #tmp
END;
*/