z_trans_yp01:--z_trans_yp01	
	SET QUOTED_IDENTIFIER OFF
	declare @t_mon nvarchar(10)
	declare @t_bdriverno nvarchar(20)
	declare @t_edriverno nvarchar(20)
	
	set @t_mon = case when '#non'=[2] then '' else [2] end
	set @t_bdriverno = case when '#non'=[3] then '' else [3] end
	set @t_edriverno = case when '#non'=[4] then char(255) else [4] end
	
	declare @tmp table(
		gno nvarchar(1),
		driverno nvarchar(100),
		driver nvarchar(200),
		noa nvarchar(100),
		oilnoa nvarchar(100),
		mon nvarchar(10),
		datea nvarchar(10),
		custno nvarchar(100),
		comp nvarchar(200),
		productno nvarchar(100),
		product nvarchar(200),
		straddr nvarchar(max),
		endaddr nvarchar(max),
		price2 float,
		mount4 float,
		plusmoney float,
		minusmoney float,
		chgmemo nvarchar(max),
		carno nvarchar(100),
		bmiles float,
		emiles float,
		miles float,
		oilrate float,
		oilmount float,
		oilprice float,
		oiltotal float,
		etcprice float,
		total float
	)
	
	insert @tmp
	select '0',a.driverno,a.driver,a.noa,b.noa,@t_mon,a.trandate,a.custno,a.nick,a.uccno,a.product,a.straddr,isnull(a.endaddr,''),isnull(a.price2,0)*2,isnull(a.mount4,0)
		,'','','',a.carno,b.bmiles,b.emiles,b.emiles-b.bmiles,b.rate,(b.emiles-b.bmiles)/nullif(b.rate,0)
		,b.price,round(((b.emiles-b.bmiles)/nullif(b.rate,0)),0)*b.price,isnull(c.money,0),0
	from view_trans a left join oil b on b.datea=a.trandate and a.carno=b.carno
	left join etc c on a.driverno=c.driverno and a.trandate=c.datea
	where left(a.trandate,6)=@t_mon
	and a.driverno between @t_bdriverno and @t_edriverno
	
	insert @tmp(gno,datea,noa,plusmoney,minusmoney,chgmemo)
	select '0',min(a.trandate),min(a.noa)noa,c.plusmoney,c.minusmoney,d.memo 
	from view_trans a
	left join view_tres b on a.noa=b.tranno
	left join view_tre c on c.noa=b.noa
	left join carchg d on c.carchgno=d.noa
	where left(a.trandate,6)=@t_mon
	and a.driverno between @t_bdriverno and @t_edriverno
	and (c.plusmoney!=0 or c.minusmoney!=0)
	group by d.noa,c.plusmoney,c.minusmoney,d.memo
	
	insert @tmp(gno,driverno,price2,mount4)
	select '3',driverno,price2,COUNT(price2)
	from @tmp
	where price2!=0 and gno=0
	group by driverno,price2
	
	insert @tmp(gno,driverno,price2,mount4)
	select '3',driverno,mount4,COUNT(mount4)
	from @tmp
	where mount4!=0 and gno=0
	group by driverno,mount4
	
	insert @tmp(gno,driverno,price2,mount4)
	select '4',driverno,price2,SUM(mount4)
	from @tmp
	group by driverno,price2
		declare @tmpa table(
		gno nvarchar(1),
		rr int,
		driverno nvarchar(100),
		driver nvarchar(200),
		noa nvarchar(100),
		mon nvarchar(10),
		datea nvarchar(10),
		custno nvarchar(100),
		comp nvarchar(200),
		productno nvarchar(100),
		product nvarchar(200),
		straddr nvarchar(max),
		endaddr nvarchar(max),
		price2 float,
		mount4 float,
		plusmoney float,
		minusmoney float,
		chgmemo nvarchar(max),
		carno nvarchar(100),
		bmiles float,
		emiles float,
		miles float,
		oilrate float,
		oilmount float,
		oilprice float,
		oiltotal float,
		etcprice float,
		total float,
		price float
	)
	
	insert @tmpa
	select '0','',driverno,max(driver),noa,max(mon),min(datea),max(custno),max(comp)
			,max(productno),max(product),max(straddr),max(endaddr),sum(price2),sum(mount4)
			,sum(plusmoney),sum(minusmoney),max(chgmemo),max(carno),sum(bmiles),sum(emiles)
			,sum(miles),sum(oilrate),sum(oilmount),sum(oilprice),sum(oiltotal),sum(etcprice)
			,0,0
	from @tmp
	where gno=0
	group by driverno,noa
	
	update a
	set rr=rx
	from (select ROW_NUMBER()over(partition by datea,driverno order by noa)rx,rr from @tmpa) a
	
	update @tmpa
	set gno=case when rr=1 then 0 else 1 end
	
	update a
	set rr=rx
	from (select ROW_NUMBER()over(partition by driverno order by datea,noa)rx,rr from @tmpa)a
	
	insert @tmpa(gno,rr,driverno,price2,mount4,plusmoney,minusmoney,miles,oilmount,oiltotal,etcprice)
	select '2','9995',driverno,SUM(price2),sum(mount4),sum(plusmoney),sum(minusmoney),sum(miles),sum(oilmount),sum(oiltotal),sum(etcprice)
	from @tmpa
	group by driverno
	
	insert @tmpa(gno,rr,driverno,endaddr,price,mount4,total)
	select '3',ROW_NUMBER()over(partition by driverno order by datea,noa),driverno,'',price2,mount4,price2*mount4
	from @tmp
	where gno=4 and price2!=0
	
	update @tmpa
	set endaddr=case when rr=1 then '金額統計' else '' end,gno=case when rr=1 then 3 else 4 end,rr='9996'
	where gno=3 
	
	insert @tmpa(gno,rr,driverno,total)
	select '5','9997',driverno,SUM(total)
	from @tmpa
	where gno=3 or gno=4
	group by driverno
	
	insert @tmpa(gno,rr,driverno,plusmoney,minusmoney,total)
	select '6','9998',driverno,sum(plusmoney),sum(minusmoney),sum(total)+sum(plusmoney)-sum(minusmoney)
	from @tmpa
	where gno=2 or gno=5
	group by driverno
	
	insert @tmpa(gno,rr,driverno)
	select '7','9999',driverno
	from @tmpa
	group by driverno
	
	select 
	gno,left(@t_mon,3)yy,right(@t_mon,2)mm,driverno,driver,right(datea,5)datea,comp,product,straddr,endaddr,chgmemo,carno
	,price
	,case when price2!=0 then dbo.getComma(price2,0)else null end price2
	,case when mount4!=0 then dbo.getComma(mount4,0) else null end mount4
	,case when plusmoney!=0 then dbo.getComma(plusmoney,0) else null end plusmoney
	,case when minusmoney!=0 then dbo.getComma(minusmoney,0) else null end minusmoney
	,dbo.getComma(bmiles,0)bmiles
	,dbo.getComma(emiles,0)emiles
	,dbo.getComma(miles,0)miles
	,dbo.getComma(oilrate,3)oilrate
	,dbo.getComma(oilmount,0)oilmount
	,dbo.getComma(oilprice,3)oilprice
	,dbo.getComma(oiltotal,0)oiltotal
	,case when etcprice!=0 then dbo.getComma(etcprice,3) else null end etcprice
	,dbo.getComma(total,0)total
	from @tmpa
	order by driverno,rr

;
-----------------------------------------------------------------------------------------------------------------------------------------------
z_trans_yp02:--z_trans_yp02
SET QUOTED_IDENTIFIER OFF
declare @cmd nvarchar(max)
declare @t_mon nvarchar(10)
set @t_mon = case when '#non'=[2] then '' else [2] end

IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	set @cmd = 'drop table #tmp'
	EXECUTE sp_executesql @cmd
END
IF OBJECT_ID('tempdb..#tmp2')is not null
BEGIN
	set @cmd = 'drop table #tmp2'
	EXECUTE sp_executesql @cmd
END
IF OBJECT_ID('tempdb..#tmp3')is not null
BEGIN
	set @cmd = 'drop table #tmp3'
	EXECUTE sp_executesql @cmd
END

------------車號<<Start>>------------
create table #tmp(
	gno nvarchar(2),
	carnoa nvarchar(100),
	ton float,
	driverno nvarchar(100),
	driver nvarchar(100),
	typea nvarchar(100),
	datea nvarchar(10),
	miles float,
	total float,
	idno int,
	pageno int,
	accno nvarchar(100),
	accc1 nvarchar(100),
	accc2 nvarchar(100),
	price1 float,--牌照稅
	price2 float,--燃料稅
	price3 float,--保險費
	price4 float,--行費
	price5 float,--代驗費
	price6 float,--車輛折舊
	price7 float,--GPRS費用
	price8 float,--監理規費
	t1 float,
	t2 float,--板台固定分攤成本
	t3 float,--固定成本總計
	
	pricec1 float,--車輛輪胎
	pricec2 float,--車輛油脂
	pricec3 float,--車輛電瓶
	pricec4 float,--車輛配材
	pricec5 float,--加油
	pricec6 float,--薪資
	pricec7 float,--電話
	pricec8 float,--修車
	pricec9 float,--輪胎修理
	pricec10 float,--通行
	pricec11 float,--雜支
	pricec12 float,--裝卸
	pricec13 float,--中途修車
	tc1 float,
	tc2 float,--板台固定分攤成本
	tc3 float,--變動成本總計
	msfee float,--管銷費用
	ctotal float,--成本合計
	tax float,--營所稅
	ttotal float,--每車盈餘
	carc float,--每車固定成本
	atotal01 float,atotal02 float,atotal03 float,atotal04 float,atotal05 float,atotal06 float,atotal07 float,atotal08 float,atotal09 float,atotal10 float,
	atotal11 float,atotal12 float,atotal13 float,atotal14 float,atotal15 float,atotal16 float,atotal17 float,atotal18 float,atotal19 float,atotal20 float,
	atotal21 float,atotal22 float,atotal23 float,atotal24 float,atotal25 float,atotal26 float,atotal27 float,atotal28 float,atotal29 float,atotal30 float,
	atotal31 float,atotal32 float,atotal33 float,atotal34 float--合計
)


insert #tmp(gno,carnoa,ton,driverno,driver,typea,miles,total)
select '0',a.carno,b.weight3,a.driverno,a.driver,b.carspecno,a.miles,a.total 
from view_trans a left join car2 b on a.carno=b.carno
where LEFT(a.trandate,6)=@t_mon and a.carno!=''
group by a.carno,b.weight3,a.driverno,a.driver,b.carspecno,a.miles,a.total 

insert #tmp(gno,carnoa,driverno,driver,datea)
select '1',a.carnoa,b.driverno,b.driver,b.trandate from #tmp a left join view_trans b on a.carnoa=b.carno 
where LEFT(trandate,6)=@t_mon and carno!=''
group by b.trandate,b.driverno,b.driver,a.carnoa

insert #tmp (gno,accno,accc1)
select '9',accc3,accc5
from view_acccs103_1
where  (accc5='2195.16' or accc5='2195.13' or accc5='1149.' or accc5='5850.06' or accc5='4102.'
or accc5='5850.02' or accc5='5850.03' or accc5='5850.07'  or accc5='5850.05' or accc5='5850.15')
and accy+'/'+LEFT(accc2,2)=@t_mon
group by accc3,accc5


--薪資
update #tmp 
set  pricec6=b.total
from #tmp a left join (select c.driverno,c.total from #tmp a left join carsal b on a.accno=b.accno left join carsals c on b.noa=c.noa where gno='9') b on a.driverno=b.driverno
where gno='0'

--折舊
update #tmp
set price6=b.depl
from #tmp a left join (select c.namea,b.depl from #tmp a
left join view_acczt b on a.accno=b.accno
left join view_accz c on b.acc1=c.acc1 where gno='9') b on a.carnoa=b.namea
where gno='0'

insert #tmp(gno,carnoa,driverno,driver,accno,accc1,accc2,price1,price2,price3,price8,price4,price5)
select '9',b.carno,b.carownerno,b.carowner,a.accno,accc1,c.caritemno
	,case when a.accc1='2195.16' and c.caritemno='501' then sum(c.outmoney-c.inmoney) end--牌照稅
	,case when a.accc1='2195.16' and c.caritemno='502' then sum(c.outmoney-c.inmoney) end--燃料稅
	,case when a.accc1='2195.16' and c.caritemno='306' then sum(c.outmoney-c.inmoney) end--保險費
	,case when a.accc1='2195.16' and c.caritemno='305' then sum(c.outmoney-c.inmoney) end--規費
	,case when a.accc1='4102.' or c.caritemno='401' then sum(c.outmoney-c.inmoney) end--行費
	,case when a.accc1='2195.16' and c.caritemno='308' then sum(c.outmoney-c.inmoney) end--檢驗費
from #tmp a
left join cara b on a.accno=b.accno
left join caras c on b.noa=c.noa
where a.accc1='2195.16' or a.accc1='4102.'
group by b.carno,b.carownerno,b.carowner,a.accno,accc1,c.caritemno

insert #tmp(gno,carnoa,driverno,driver,accno,accc1,price7,pricec5,pricec10,pricec12)
select '9',d.carno,d.driverno,d.driver,a.accno,a.accc1
	,case when d.acc1='2195.13' then d.minusmoney-d.plusmoney else ''end--GPS
	,case when d.acc1='1149.' then d.minusmoney-d.plusmoney else ''end--加油
	,case when d.acc1='5850.06' then d.minusmoney-d.plusmoney else ''end--通行
	,case when d.acc1='5850.15' then d.minusmoney-d.plusmoney else ''end--裝卸
from #tmp a
left join tre_accc b on a.accno=b.accno1 or a.accno=b.accno2 or a.accno=b.accno3
left join view_tre c on b.noa=c.tre_acccno
left join carchg d on (c.noa=d.treno or a.accno=d.accno)
where accc1='2195.13' or accc1='2191.' or accc1='1149.' or accc1='5850.06' or accc1='5850.15'
group by d.carno,d.driverno,d.driver,a.accno,a.accc1,d.acc1,d.minusmoney,d.plusmoney

insert #tmp(gno,carnoa,driverno,driver,accno,accc1,pricec1,pricec8)
select '9',d.carno,d.driverno,d.driver,a.accno,a.accc1
	,case when c.acc1='5850.02' and d.cacc1='5850.02' then cmoney else 0 end --輪胎
	,case when c.acc1='5850.03' and d.wacc1='5850.03' then wmoney else 0 end --修車
from #tmp a 
left join payb b on a.accno=b.accno 
left join paybs c on b.noa=c.noa 
left join fixa d on c.rc2no=d.noa
left join fixas e on e.noa=d.noa
where accc1='5850.03' or accc1='5850.02'
group by d.carno,d.driverno,d.driver,a.accno,a.accc1,d.cacc1,d.wacc1,c.acc1,cmoney,wmoney

insert #tmp(carnoa,pageno,ton,driverno,driver,typea,datea,miles,total,price1,price2,price3,price4,price5,price6,price7,price8,t2,pricec1,pricec2,pricec3,pricec4,pricec5,pricec6,pricec7,pricec8,pricec9,pricec10,pricec11,pricec12,pricec13,tc2)
select carnoa,'1',max(ton),driverno,max(driver),max(typea),count(datea),sum(miles),sum(total),SUM(price1),SUM(price2),SUM(price3),SUM(price4),SUM(price5),SUM(price6),SUM(price7),SUM(price8),'0'
		,sum(pricec1),sum(pricec2),sum(pricec3),sum(pricec4),sum(pricec5),max(pricec6),sum(pricec7),sum(pricec8),sum(pricec9),sum(pricec10),sum(pricec11),sum(pricec12),sum(pricec13),'0'
from #tmp
group by carnoa,driverno

delete #tmp where gno=0 or gno=1 or gno=9

update #tmp
set
t1=isnull(price1,0)+isnull(price2,0)+isnull(price3,0)+isnull(price4,0)+isnull(price5,0)+isnull(price6,0)+isnull(price7,0)+isnull(price8,0),
tc1=isnull(pricec1,0)+isnull(pricec2,0)+isnull(pricec3,0)+isnull(pricec4,0)+isnull(pricec5,0)+isnull(pricec6,0)+isnull(pricec7,0)+isnull(pricec8,0)+isnull(pricec9,0)+isnull(pricec10,0)+isnull(pricec11,0)+isnull(pricec12,0)+isnull(pricec13,0),
msfee=round(total*0.09,0),tax=round(total*0.012,0),carc=round((total/nullif(miles,0)),0)

update #tmp
set t3=isnull(t1,0)-isnull(t2,0),tc3=isnull(tc1,0)-isnull(tc2,0)

update #tmp
set ctotal=isnull(t3,0)+isnull(tc3,0)+isnull(msfee,0)

update #tmp
set ttotal=isnull(total,0)-isnull(ctotal,0)-isnull(tax,0)

update a
set idno=rr
from (select ROW_NUMBER()over(PARTITION by pageno order by typea,ton desc,carnoa)rr,idno from #tmp where len(carnoa)!=0)a
-----更新頁數<<Start>>-----
declare @pageno int=19
update a
set pageno=ceiling(cast(idno as float)/@pageno)
from #tmp a
-----更新頁數<<End>>-------

delete #tmp where isnull(pageno,'')=''

update #tmp
set atotal01=b.miles,atotal02=b.total,atotal03=b.price1,atotal04=b.price2,atotal05=b.price3,atotal06=b.price4,atotal07=b.price5,atotal08=b.price6,atotal09=b.price7,atotal10=b.price8
	,atotal11=b.t1,atotal12=b.t2,atotal13=b.t3,atotal14=b.pricec1,atotal15=b.pricec2,atotal16=b.pricec3,atotal17=b.pricec4,atotal18=b.pricec5,atotal19=b.pricec6,atotal20=b.pricec7
	,atotal21=b.pricec8,atotal22=b.pricec9,atotal23=b.pricec10,atotal24=b.pricec11,atotal25=b.pricec12,atotal26=b.pricec13,atotal27=b.tc1,atotal28=b.tc2,atotal29=b.tc3,atotal30=b.msfee
	,atotal31=b.ctotal,atotal32=b.tax,atotal33=b.ttotal,atotal34=b.carc
from #tmp a left join 
(select pageno,SUM(miles)miles,SUM(total)total
,SUM(price1)price1,SUM(price2)price2,SUM(price3)price3,SUM(price4)price4,SUM(price5)price5,SUM(price6)price6,SUM(price7)price7,SUM(price8)price8
,SUM(t1)t1,SUM(t2)t2,SUM(t3)t3,SUM(pricec1)pricec1,SUM(pricec2)pricec2,SUM(pricec3)pricec3,SUM(pricec4)pricec4,SUM(pricec5)pricec5,SUM(pricec6)pricec6,SUM(pricec7)pricec7
,SUM(pricec8)pricec8,SUM(pricec9)pricec9,SUM(pricec10)pricec10,SUM(pricec11)pricec11,SUM(pricec12)pricec12,SUM(pricec13)pricec13,SUM(tc1)tc1,SUM(tc2)tc2,SUM(tc3)tc3,SUM(msfee)msfee
,SUM(ctotal)ctotal,SUM(tax)tax,SUM(ttotal)ttotal,SUM(carc)carc
from #tmp group by pageno) b on a.pageno=b.pageno

create table #tmp2(
	gno nvarchar(1),
	pageno int,
	a1 nvarchar(100),
	ac1 nvarchar(100),
	ac2 nvarchar(100),
	acc1 nvarchar(100),
	acc2 nvarchar(100),
	acc3 nvarchar(100),	
	acc4 nvarchar(100),	
	acc5 nvarchar(100),	
	acc6 nvarchar(100),	
	acc7 nvarchar(100),	
	acc8 nvarchar(100),
	accc1 nvarchar(100),	
	accc2 nvarchar(100),
	accc3 nvarchar(100),
	accc4 nvarchar(100),
	accc5 nvarchar(100),
	accc6 nvarchar(100),
	accc7 nvarchar(100),
	accc8 nvarchar(100),
	accc9 nvarchar(100),
	accc10 nvarchar(100),
	accc11 nvarchar(100),
	accc12 nvarchar(100),
	accc13 nvarchar(100),
)
insert #tmp2(pageno)
select pageno from #tmp group by pageno

insert #tmp2 (gno,a1,ac2)
select '0',accc5,accc6
from view_acccs103_1
where  (accc5='2195.16'or accc5='2195.13' or accc5='1149.' or accc5='5850.06' or accc5='4102.'
or accc5='5850.02' or accc5='5850.03' or accc5='5850.07'  or accc5='5850.05' or accc5='5850.15')
and accy+'/'+LEFT(accc2,2)=@t_mon
group by accc5,accc6

insert #tmp2 (gno,a1,ac1,ac2)
select '9',a1,b.caritemno,a.ac2+' - ' +caritem
from #tmp2 a
left join caras b on a.a1=b.acc1
where a1='2195.16' or a1='4102.'
group by a1,a.ac2,caritem,b.caritemno

insert #tmp2 (gno,a1,ac1,ac2)
select '9',a1,b.cacc1,b.cacc2
from #tmp2 a
left join fixa b on a.a1=b.cacc1
where accc1='5850.03'
group by a1,b.cacc1,b.cacc2

declare @noacount int=1
while(@noacount<=@pageno)
begin
	
		exec("update #tmp2 set acc1=a.ac2 from (select ac2 from #tmp2 where a1='2195.16' and ac1='501')a")
		exec("update #tmp2 set acc2=a.ac2 from (select ac2 from #tmp2 where a1='2195.16' and ac1='502')a")
		exec("update #tmp2 set acc3=a.ac2 from (select ac2 from #tmp2 where a1='2195.16' and ac1='306')a")
		exec("update #tmp2 set acc4=a.ac2 from (select ac2 from #tmp2 where a1='4102.' and ac1='401')a")
		exec("update #tmp2 set acc5=a.ac2 from (select ac2 from #tmp2 where a1='2195.16' and ac1='308')a")
		exec("update #tmp2 set acc6=a.ac2 from (select ac2 from #tmp2 where a1='5850.05')a")
		exec("update #tmp2 set acc7=a.ac2 from (select ac2 from #tmp2 where a1='2195.13')a")
		exec("update #tmp2 set acc8=a.ac2 from (select ac2 from #tmp2 where a1='2195.16' and ac1='305')a")
		exec("update #tmp2 set accc1=a.ac2 from (select ac2 from #tmp2 where a1='5850.02')a")
		exec("update #tmp2 set accc2='行車費用 - 車輛油脂'")
		exec("update #tmp2 set accc3='行車費用 - 車輛電瓶'")
		exec("update #tmp2 set accc4='行車費用 - 車輛配材'")
		exec("update #tmp2 set accc5=a.ac2+' - '+'加油費' from (select ac2 from #tmp2 where a1='1149.')a")
		exec("update #tmp2 set accc6=a.ac2 from (select ac2 from #tmp2 where a1='5850.07' and left(ac2,1)='司')a")
		exec("update #tmp2 set accc7='行車費用 - 電話費'")
		exec("update #tmp2 set accc8=a.ac2 from (select ac2 from #tmp2 where a1='5850.03')a")
		exec("update #tmp2 set accc9='行車費用 - 車輛輪胎修理費'")
		exec("update #tmp2 set accc10=a.ac2 from (select ac2 from #tmp2 where a1='5850.06')a")
		exec("update #tmp2 set accc11='行車費用 - 雜支'")
		exec("update #tmp2 set accc12=replace(a.ac2,' ','')+' - '+'裝卸費' from (select ac2 from #tmp2 where a1='5850.15')a")
		exec("update #tmp2 set accc13='行車費用 - 途中修車費'")
	set @noacount=@noacount+1
end

delete #tmp2 where gno='0' or gno='9'

create table #tmp3(
	gno nvarchar(1),
	pageno int,
 	atotal float,atotal2 float,atotal3 float,atotal4 float,atotal5 float,atotal6 float,atotal7 float,atotal8 float,atotal9 float,atotal10 float,
	atotal11 float,atotal12 float,atotal13 float,atotal14 float,atotal15 float,atotal16 float,atotal17 float,atotal18 float,atotal19 float,atotal20 float,
	atotal21 float,atotal22 float,atotal23 float,atotal24 float,atotal25 float,atotal26 float,atotal27 float,atotal28 float,atotal29 float,atotal30 float,
	atotal31 float,atotal32 float,atotal33 float,atotal34 float,
	noa01 nvarchar(100),noa02 nvarchar(100),noa03 nvarchar(100),noa04 nvarchar(100),noa05 nvarchar(100),
	noa06 nvarchar(100),noa07 nvarchar(100),noa08 nvarchar(100),noa09 nvarchar(100),noa10 nvarchar(100),
	noa11 nvarchar(100),noa12 nvarchar(100),noa13 nvarchar(100),noa14 nvarchar(100),noa15 nvarchar(100),
	noa16 nvarchar(100),noa17 nvarchar(100),noa18 nvarchar(100),noa19 nvarchar(100),
	a01 float,a02 float,a03 float,a04 float,a05 float,a06 float,a07 float,a08 float,a09 float,a10 float,
	a11 float,a12 float,a13 float,a14 float,a15 float,a16 float,a17 float,a18 float,a19 float,
	b01 nvarchar(20),b02 nvarchar(20),b03 nvarchar(20),b04 nvarchar(20),b05 nvarchar(20),
	b06 nvarchar(20),b07 nvarchar(20),b08 nvarchar(20),b09 nvarchar(20),b10 nvarchar(20),
	b11 nvarchar(20),b12 nvarchar(20),b13 nvarchar(20),b14 nvarchar(20),b15 nvarchar(20),
	b16 nvarchar(20),b17 nvarchar(20),b18 nvarchar(20),b19 nvarchar(20),
	c01 nvarchar(20),c02 nvarchar(20),c03 nvarchar(20),c04 nvarchar(20),c05 nvarchar(20),
	c06 nvarchar(20),c07 nvarchar(20),c08 nvarchar(20),c09 nvarchar(20),c10 nvarchar(20),
	c11 nvarchar(20),c12 nvarchar(20),c13 nvarchar(20),c14 nvarchar(20),c15 nvarchar(20),
	c16 nvarchar(20),c17 nvarchar(20),c18 nvarchar(20),c19 nvarchar(20),
	d01 float,d02 float,d03 float,d04 float,d05 float,d06 float,d07 float,d08 float,d09 float,d10 float,
	d11 float,d12 float,d13 float,d14 float,d15 float,d16 float,d17 float,d18 float,d19 float,
	e01 float,e02 float,e03 float,e04 float,e05 float,e06 float,e07 float,e08 float,e09 float,e10 float,
	e11 float,e12 float,e13 float,e14 float,e15 float,e16 float,e17 float,e18 float,e19 float,
	al01 float,al02 float,al03 float,al04 float,al05 float,al06 float,al07 float,al08 float,al09 float,al10 float,
	al11 float,al12 float,al13 float,al14 float,al15 float,al16 float,al17 float,al18 float,al19 float,
	am01 float,am02 float,am03 float,am04 float,am05 float,am06 float,am07 float,am08 float,am09 float,am10 float,
	am11 float,am12 float,am13 float,am14 float,am15 float,am16 float,am17 float,am18 float,am19 float,
	f01 float,f02 float,f03 float,f04 float,f05 float,f06 float,f07 float,f08 float,f09 float,f10 float,
	f11 float,f12 float,f13 float,f14 float,f15 float,f16 float,f17 float,f18 float,f19 float,
	h01 float,h02 float,h03 float,h04 float,h05 float,h06 float,h07 float,h08 float,h09 float,h10 float,
	h11 float,h12 float,h13 float,h14 float,h15 float,h16 float,h17 float,h18 float,h19 float,
	i01 float,i02 float,i03 float,i04 float,i05 float,i06 float,i07 float,i08 float,i09 float,i10 float,
	i11 float,i12 float,i13 float,i14 float,i15 float,i16 float,i17 float,i18 float,i19 float,
	j01 float,j02 float,j03 float,j04 float,j05 float,j06 float,j07 float,j08 float,j09 float,j10 float,
	j11 float,j12 float,j13 float,j14 float,j15 float,j16 float,j17 float,j18 float,j19 float,
	k01 float,k02 float,k03 float,k04 float,k05 float,k06 float,k07 float,k08 float,k09 float,k10 float,
	k11 float,k12 float,k13 float,k14 float,k15 float,k16 float,k17 float,k18 float,k19 float,
	l01 float,l02 float,l03 float,l04 float,l05 float,l06 float,l07 float,l08 float,l09 float,l10 float,
	l11 float,l12 float,l13 float,l14 float,l15 float,l16 float,l17 float,l18 float,l19 float,
	m01 float,m02 float,m03 float,m04 float,m05 float,m06 float,m07 float,m08 float,m09 float,m10 float,
	m11 float,m12 float,m13 float,m14 float,m15 float,m16 float,m17 float,m18 float,m19 float,
	n01 float,n02 float,n03 float,n04 float,n05 float,n06 float,n07 float,n08 float,n09 float,n10 float,
	n11 float,n12 float,n13 float,n14 float,n15 float,n16 float,n17 float,n18 float,n19 float,
	o01 float,o02 float,o03 float,o04 float,o05 float,o06 float,o07 float,o08 float,o09 float,o10 float,
	o11 float,o12 float,o13 float,o14 float,o15 float,o16 float,o17 float,o18 float,o19 float,
	p01 float,p02 float,p03 float,p04 float,p05 float,p06 float,p07 float,p08 float,p09 float,p10 float,
	p11 float,p12 float,p13 float,p14 float,p15 float,p16 float,p17 float,p18 float,p19 float,
	q01 float,q02 float,q03 float,q04 float,q05 float,q06 float,q07 float,q08 float,q09 float,q10 float,
	q11 float,q12 float,q13 float,q14 float,q15 float,q16 float,q17 float,q18 float,q19 float,
	r01 float,r02 float,r03 float,r04 float,r05 float,r06 float,r07 float,r08 float,r09 float,r10 float,
	r11 float,r12 float,r13 float,r14 float,r15 float,r16 float,r17 float,r18 float,r19 float,
	s01 float,s02 float,s03 float,s04 float,s05 float,s06 float,s07 float,s08 float,s09 float,s10 float,
	s11 float,s12 float,s13 float,s14 float,s15 float,s16 float,s17 float,s18 float,s19 float,
	t01 float,t02 float,t03 float,t04 float,t05 float,t06 float,t07 float,t08 float,t09 float,t10 float,
	t11 float,t12 float,t13 float,t14 float,t15 float,t16 float,t17 float,t18 float,t19 float,
	u01 float,u02 float,u03 float,u04 float,u05 float,u06 float,u07 float,u08 float,u09 float,u10 float,
	u11 float,u12 float,u13 float,u14 float,u15 float,u16 float,u17 float,u18 float,u19 float,
	v01 float,v02 float,v03 float,v04 float,v05 float,v06 float,v07 float,v08 float,v09 float,v10 float,
	v11 float,v12 float,v13 float,v14 float,v15 float,v16 float,v17 float,v18 float,v19 float,
	w01 float,w02 float,w03 float,w04 float,w05 float,w06 float,w07 float,w08 float,w09 float,w10 float,
	w11 float,w12 float,w13 float,w14 float,w15 float,w16 float,w17 float,w18 float,w19 float,
	x01 float,x02 float,x03 float,x04 float,x05 float,x06 float,x07 float,x08 float,x09 float,x10 float,
	x11 float,x12 float,x13 float,x14 float,x15 float,x16 float,x17 float,x18 float,x19 float,
	y01 float,y02 float,y03 float,y04 float,y05 float,y06 float,y07 float,y08 float,y09 float,y10 float,
	y11 float,y12 float,y13 float,y14 float,y15 float,y16 float,y17 float,y18 float,y19 float,
	z01 float,z02 float,z03 float,z04 float,z05 float,z06 float,z07 float,z08 float,z09 float,z10 float,
	z11 float,z12 float,z13 float,z14 float,z15 float,z16 float,z17 float,z18 float,z19 float,
	aa01 float,aa02 float,aa03 float,aa04 float,aa05 float,aa06 float,aa07 float,aa08 float,aa09 float,aa10 float,
	aa11 float,aa12 float,aa13 float,aa14 float,aa15 float,aa16 float,aa17 float,aa18 float,aa19 float,
	ab01 float,ab02 float,ab03 float,ab04 float,ab05 float,ab06 float,ab07 float,ab08 float,ab09 float,ab10 float,
	ab11 float,ab12 float,ab13 float,ab14 float,ab15 float,ab16 float,ab17 float,ab18 float,ab19 float,
	ac01 float,ac02 float,ac03 float,ac04 float,ac05 float,ac06 float,ac07 float,ac08 float,ac09 float,ac10 float,
	ac11 float,ac12 float,ac13 float,ac14 float,ac15 float,ac16 float,ac17 float,ac18 float,ac19 float,
	ad01 float,ad02 float,ad03 float,ad04 float,ad05 float,ad06 float,ad07 float,ad08 float,ad09 float,ad10 float,
	ad11 float,ad12 float,ad13 float,ad14 float,ad15 float,ad16 float,ad17 float,ad18 float,ad19 float,
	ae01 float,ae02 float,ae03 float,ae04 float,ae05 float,ae06 float,ae07 float,ae08 float,ae09 float,ae10 float,
	ae11 float,ae12 float,ae13 float,ae14 float,ae15 float,ae16 float,ae17 float,ae18 float,ae19 float,
	af01 float,af02 float,af03 float,af04 float,af05 float,af06 float,af07 float,af08 float,af09 float,af10 float,
	af11 float,af12 float,af13 float,af14 float,af15 float,af16 float,af17 float,af18 float,af19 float,
	ag01 float,ag02 float,ag03 float,ag04 float,ag05 float,ag06 float,ag07 float,ag08 float,ag09 float,ag10 float,
	ag11 float,ag12 float,ag13 float,ag14 float,ag15 float,ag16 float,ag17 float,ag18 float,ag19 float,
	ah01 float,ah02 float,ah03 float,ah04 float,ah05 float,ah06 float,ah07 float,ah08 float,ah09 float,ah10 float,
	ah11 float,ah12 float,ah13 float,ah14 float,ah15 float,ah16 float,ah17 float,ah18 float,ah19 float,
	ai01 float,ai02 float,ai03 float,ai04 float,ai05 float,ai06 float,ai07 float,ai08 float,ai09 float,ai10 float,
	ai11 float,ai12 float,ai13 float,ai14 float,ai15 float,ai16 float,ai17 float,ai18 float,ai19 float,
	aj01 float,aj02 float,aj03 float,aj04 float,aj05 float,aj06 float,aj07 float,aj08 float,aj09 float,aj10 float,
	aj11 float,aj12 float,aj13 float,aj14 float,aj15 float,aj16 float,aj17 float,aj18 float,aj19 float
)

insert #tmp3(pageno,atotal,atotal2,atotal3,atotal4,atotal5,atotal6,atotal7,atotal8,atotal9,atotal10,
	atotal11,atotal12,atotal13,atotal14,atotal15,atotal16,atotal17,atotal18,atotal19,atotal20,
	atotal21,atotal22,atotal23,atotal24,atotal25,atotal26,atotal27,atotal28,atotal29,atotal30,
	atotal31,atotal32,atotal33,atotal34)
select a.pageno,MAX(a.atotal01),MAX(a.atotal02),MAX(a.atotal03),MAX(a.atotal04),MAX(a.atotal05),MAX(a.atotal06),MAX(a.atotal07),MAX(a.atotal08),MAX(a.atotal09),MAX(a.atotal10) 
	 ,MAX(a.atotal11),MAX(a.atotal12),MAX(a.atotal13),MAX(a.atotal14),MAX(a.atotal15),MAX(a.atotal16),MAX(a.atotal17),MAX(a.atotal18),MAX(a.atotal19),MAX(a.atotal20)
	 ,MAX(a.atotal21),MAX(a.atotal22),MAX(a.atotal23),MAX(a.atotal24),MAX(a.atotal25),MAX(a.atotal26),MAX(a.atotal27),MAX(a.atotal28),MAX(a.atotal29),MAX(a.atotal30) 
	 ,MAX(a.atotal31),MAX(a.atotal32),MAX(a.atotal33),MAX(a.atotal34) 
from #tmp a left join #tmp2 b on a.pageno=b.pageno 
group by a.pageno

set @noacount=1
declare @tmp_noacol nvarchar(50)
declare @tmp_noaa nvarchar(50)
declare @tmp_noab nvarchar(50)
declare @tmp_noac nvarchar(50)
declare @tmp_noad nvarchar(50)
declare @tmp_noae nvarchar(50)
declare @tmp_noaal nvarchar(50)
declare @tmp_noaam nvarchar(50)
declare @tmp_noaf nvarchar(50)
declare @tmp_noah nvarchar(50)
declare @tmp_noai nvarchar(50)
declare @tmp_noaj nvarchar(50)
declare @tmp_noak nvarchar(50)
declare @tmp_noal nvarchar(50)
declare @tmp_noam nvarchar(50)
declare @tmp_noan nvarchar(50)
declare @tmp_noao nvarchar(50)
declare @tmp_noap nvarchar(50)
declare @tmp_noaq nvarchar(50)
declare @tmp_noar nvarchar(50)
declare @tmp_noas nvarchar(50)
declare @tmp_noat nvarchar(50)
declare @tmp_noau nvarchar(50)
declare @tmp_noav nvarchar(50)
declare @tmp_noaw nvarchar(50)
declare @tmp_noax nvarchar(50)
declare @tmp_noay nvarchar(50)
declare @tmp_noaz nvarchar(50)
declare @tmp_noaaa nvarchar(50)
declare @tmp_noaab nvarchar(50)
declare @tmp_noaac nvarchar(50)
declare @tmp_noaad nvarchar(50)
declare @tmp_noaae nvarchar(50)
declare @tmp_noaaf nvarchar(50)
declare @tmp_noaag nvarchar(50)
declare @tmp_noaah nvarchar(50)
declare @tmp_noaai nvarchar(50)
declare @tmp_noaaj nvarchar(50)
declare @tmp_noaak nvarchar(50)
--while(@tmp_mon<=@t_emon and @moncount<=12)
while(@noacount<=@pageno)
begin
	set @tmp_noacol='noa'+right('00'+cast(@noacount as nvarchar(10)),2)--車號
	set @tmp_noaa='a'+right('00'+cast(@noacount as nvarchar(10)),2)--噸數
	set @tmp_noab='b'+right('00'+cast(@noacount as nvarchar(10)),2)--駕駛
	set @tmp_noac='c'+right('00'+cast(@noacount as nvarchar(10)),2)--出車天數
	set @tmp_noad='d'+right('00'+cast(@noacount as nvarchar(10)),2)--行駛公里數
	set @tmp_noae='e'+right('00'+cast(@noacount as nvarchar(10)),2)--貨運收入
	set @tmp_noaal='al'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaam='am'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaf='f'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noah='h'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noai='i'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaj='j'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noak='k'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noal='l'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noam='m'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noan='n'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noao='o'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noap='p'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaq='q'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noar='r'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noas='s'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noat='t'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noau='u'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noav='v'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaw='w'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noax='x'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noay='y'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaz='z'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaaa='aa'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaab='ab'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaac='ac'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaad='ad'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaae='ae'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaaf='af'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaag='ag'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaah='ah'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaai='ai'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaaj='aj'+right('00'+cast(@noacount as nvarchar(10)),2)
	set @tmp_noaak='ak'+right('00'+cast(@noacount as nvarchar(10)),2)

if(@noacount=1)
		exec("update #tmp3 
		set gno=0,"+@tmp_noacol+"=a.carnoa,"+@tmp_noaa+"=a.ton,"+@tmp_noab+"=a.driver,"+@tmp_noac+"=a.datea
		,"+@tmp_noad+"= a.miles,"+@tmp_noae+"= a.total,"+@tmp_noaal+"= a.price1,"+@tmp_noaam+"= a.price2
		,"+@tmp_noaf+"= a.price3,"+@tmp_noah+"= a.price4,"+@tmp_noai+"= a.price5,"+@tmp_noaj+"= a.price6
		,"+@tmp_noak+"= a.price7,"+@tmp_noal+"= a.price8,"+@tmp_noam+"= a.t1,"+@tmp_noan+"= a.t2
		,"+@tmp_noao+"= a.t3,"+@tmp_noap+"= a.pricec1,"+@tmp_noaq+"= a.pricec2,"+@tmp_noar+"= a.pricec3
		,"+@tmp_noas+"= a.pricec4,"+@tmp_noat+"= a.pricec5,"+@tmp_noau+"= a.pricec6,"+@tmp_noav+"= a.pricec7
		,"+@tmp_noaw+"= a.pricec8,"+@tmp_noax+"= a.pricec9,"+@tmp_noay+"= a.pricec10,"+@tmp_noaz+"= a.pricec11
		,"+@tmp_noaaa+"= a.pricec12,"+@tmp_noaab+"= a.pricec13,"+@tmp_noaac+"= a.tc1,"+@tmp_noaad+"= a.tc2
		,"+@tmp_noaae+"= a.tc3,"+@tmp_noaaf+"= a.msfee,"+@tmp_noaag+"= a.ctotal,"+@tmp_noaah+"= a.tax
		,"+@tmp_noaai+"= a.ttotal,"+@tmp_noaaj+"= a.carc
		from #tmp a left join #tmp3 b on a.pageno=b.pageno where a.idno % "+@pageno+"="+@noacount)
	else if(@noacount=19)
		exec("update #tmp3 
		set "+@tmp_noacol+"=a.carnoa,"+@tmp_noaa+"=a.ton,"+@tmp_noab+"=a.driver,"+@tmp_noac+"=a.datea
		,"+@tmp_noad+"= a.miles,"+@tmp_noae+"= a.total,"+@tmp_noaal+"= a.price1,"+@tmp_noaam+"= a.price2
		,"+@tmp_noaf+"= a.price3,"+@tmp_noah+"= a.price4,"+@tmp_noai+"= a.price5,"+@tmp_noaj+"= a.price6
		,"+@tmp_noak+"= a.price7,"+@tmp_noal+"= a.price8,"+@tmp_noam+"= a.t1,"+@tmp_noan+"= a.t2
		,"+@tmp_noao+"= a.t3,"+@tmp_noap+"= a.pricec1,"+@tmp_noaq+"= a.pricec2,"+@tmp_noar+"= a.pricec3
		,"+@tmp_noas+"= a.pricec4,"+@tmp_noat+"= a.pricec5,"+@tmp_noau+"= a.pricec6,"+@tmp_noav+"= a.pricec7
		,"+@tmp_noaw+"= a.pricec8,"+@tmp_noax+"= a.pricec9,"+@tmp_noay+"= a.pricec10,"+@tmp_noaz+"= a.pricec11
		,"+@tmp_noaaa+"= a.pricec12,"+@tmp_noaab+"= a.pricec13,"+@tmp_noaac+"= a.tc1,"+@tmp_noaad+"= a.tc2
		,"+@tmp_noaae+"= a.tc3,"+@tmp_noaaf+"= a.msfee,"+@tmp_noaag+"= a.ctotal,"+@tmp_noaah+"= a.tax
		,"+@tmp_noaai+"= a.ttotal,"+@tmp_noaaj+"= a.carc
		from #tmp a left join #tmp3 b on a.pageno=b.pageno where a.idno % "+@pageno+"=0")
	else
		exec("update #tmp3 
		set "+@tmp_noacol+"=a.carnoa,"+@tmp_noaa+"=a.ton,"+@tmp_noab+"=a.driver,"+@tmp_noac+"=a.datea
		,"+@tmp_noad+"= a.miles,"+@tmp_noae+"= a.total,"+@tmp_noaal+"= a.price1,"+@tmp_noaam+"= a.price2
		,"+@tmp_noaf+"= a.price3,"+@tmp_noah+"= a.price4,"+@tmp_noai+"= a.price5,"+@tmp_noaj+"= a.price6
		,"+@tmp_noak+"= a.price7,"+@tmp_noal+"= a.price8,"+@tmp_noam+"= a.t1,"+@tmp_noan+"= a.t2
		,"+@tmp_noao+"= a.t3,"+@tmp_noap+"= a.pricec1,"+@tmp_noaq+"= a.pricec2,"+@tmp_noar+"= a.pricec3
		,"+@tmp_noas+"= a.pricec4,"+@tmp_noat+"= a.pricec5,"+@tmp_noau+"= a.pricec6,"+@tmp_noav+"= a.pricec7
		,"+@tmp_noaw+"= a.pricec8,"+@tmp_noax+"= a.pricec9,"+@tmp_noay+"= a.pricec10,"+@tmp_noaz+"= a.pricec11
		,"+@tmp_noaaa+"= a.pricec12,"+@tmp_noaab+"= a.pricec13,"+@tmp_noaac+"= a.tc1,"+@tmp_noaad+"= a.tc2
		,"+@tmp_noaae+"= a.tc3,"+@tmp_noaaf+"= a.msfee,"+@tmp_noaag+"= a.ctotal,"+@tmp_noaah+"= a.tax
		,"+@tmp_noaai+"= a.ttotal,"+@tmp_noaaj+"= a.carc
		from #tmp a left join #tmp3 b on a.pageno=b.pageno where a.idno % "+@pageno+"="+@noacount)
	set @noacount=@noacount+1
	
end

select
LEFT(@t_mon,3)yy,right(@t_mon,2)mm,a.gno,
case when atotal=0 then '' else dbo.getcomma(atotal,0)end atotal01,case when atotal2=0 then '' else dbo.getcomma(atotal2,0)end atotal02,
case when atotal3=0 then '' else dbo.getcomma(atotal3,0)end atotal03,case when atotal4=0 then '' else dbo.getcomma(atotal4,0)end atotal04,
case when atotal5=0 then '' else dbo.getcomma(atotal5,0)end atotal05,case when atotal6=0 then '' else dbo.getcomma(atotal6,0)end atotal06,
case when atotal7=0 then '' else dbo.getcomma(atotal7,0)end atotal07,case when atotal8=0 then '' else dbo.getcomma(atotal8,0)end atotal08,
case when atotal9=0 then '' else dbo.getcomma(atotal9,0)end atotal09,case when atotal10=0 then '' else dbo.getcomma(atotal10,0)end atotal10,
case when atotal11=0 then '' else dbo.getcomma(atotal11,0)end atotal11,case when atotal12=0 then '' else dbo.getcomma(atotal12,0)end atotal12,
case when atotal13=0 then '' else dbo.getcomma(atotal13,0)end atotal13,case when atotal14=0 then '' else dbo.getcomma(atotal14,0)end atotal14,
case when atotal15=0 then '' else dbo.getcomma(atotal15,0)end atotal15,case when atotal16=0 then '' else dbo.getcomma(atotal16,0)end atotal16,
case when atotal17=0 then '' else dbo.getcomma(atotal17,0)end atotal17,case when atotal18=0 then '' else dbo.getcomma(atotal18,0)end atotal18,
case when atotal19=0 then '' else dbo.getcomma(atotal19,0)end atotal19,case when atotal20=0 then '' else dbo.getcomma(atotal20,0)end atotal20,
case when atotal21=0 then '' else dbo.getcomma(atotal21,0)end atotal21,case when atotal22=0 then '' else dbo.getcomma(atotal22,0)end atotal22,
case when atotal23=0 then '' else dbo.getcomma(atotal23,0)end atotal23,case when atotal24=0 then '' else dbo.getcomma(atotal24,0)end atotal24,
case when atotal25=0 then '' else dbo.getcomma(atotal25,0)end atotal25,case when atotal26=0 then '' else dbo.getcomma(atotal26,0)end atotal26,
case when atotal27=0 then '' else dbo.getcomma(atotal27,0)end atotal27,case when atotal28=0 then '' else dbo.getcomma(atotal28,0)end atotal28,
case when atotal29=0 then '' else dbo.getcomma(atotal29,0)end atotal29,case when atotal30=0 then '' else dbo.getcomma(atotal30,0)end atotal30,
case when atotal31=0 then '' else dbo.getcomma(atotal31,0)end atotal31,case when atotal32=0 then '' else dbo.getcomma(atotal32,0)end atotal32,
case when atotal33=0 then '' else dbo.getcomma(atotal33,0)end atotal33,case when atotal34=0 then '' else dbo.getcomma(atotal34,0)end atotal34,
a.pageno,noa01,noa02,noa03,noa04,noa05,noa06,noa07,noa08,noa09,noa10,noa11,noa12,noa13,noa14,noa15,noa16,noa17,noa18,noa19
,a01,a02,a03,a04,a05,a06,a07,a08,a09,a10,a11,a12,a13,a14,a15,a16,a17,a18,a19
,b01,b02,b03,b04,b05,b06,b07,b08,b09,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19
,c01,c02,c03,c04,c05,c06,c07,c08,c09,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,
case when d01=0 then '' else dbo.getcomma(d01,0)end d01,case when d02=0 then '' else dbo.getcomma(d02,0)end d02,
case when d03=0 then '' else dbo.getcomma(d03,0)end d03,case when d04=0 then '' else dbo.getcomma(d04,0)end d04,
case when d05=0 then '' else dbo.getcomma(d05,0)end d05,case when d06=0 then '' else dbo.getcomma(d06,0)end d06,
case when d07=0 then '' else dbo.getcomma(d07,0)end d07,case when d08=0 then '' else dbo.getcomma(d08,0)end d08,
case when d09=0 then '' else dbo.getcomma(d09,0)end d09,case when d10=0 then '' else dbo.getcomma(d10,0)end d10,
case when d11=0 then '' else dbo.getcomma(d11,0)end d11,case when d12=0 then '' else dbo.getcomma(d12,0)end d12,
case when d13=0 then '' else dbo.getcomma(d13,0)end d13,case when d14=0 then '' else dbo.getcomma(d14,0)end d14,
case when d15=0 then '' else dbo.getcomma(d15,0)end d15,case when d16=0 then '' else dbo.getcomma(d16,0)end d16,
case when d17=0 then '' else dbo.getcomma(d17,0)end d17,case when d18=0 then '' else dbo.getcomma(d18,0)end d18,
case when d19=0 then '' else dbo.getcomma(d19,0)end d19,
case when e01=0 then '' else dbo.getcomma(e01,0)end e01,case when e02=0 then '' else dbo.getcomma(e02,0)end e02,
case when e03=0 then '' else dbo.getcomma(e03,0)end e03,case when e04=0 then '' else dbo.getcomma(e04,0)end e04,
case when e05=0 then '' else dbo.getcomma(e05,0)end e05,case when e06=0 then '' else dbo.getcomma(e06,0)end e06,
case when e07=0 then '' else dbo.getcomma(e07,0)end e07,case when e08=0 then '' else dbo.getcomma(e08,0)end e08,
case when e09=0 then '' else dbo.getcomma(e09,0)end e09,case when e10=0 then '' else dbo.getcomma(e10,0)end e10,
case when e11=0 then '' else dbo.getcomma(e11,0)end e11,case when e12=0 then '' else dbo.getcomma(e12,0)end e12,
case when e13=0 then '' else dbo.getcomma(e13,0)end e13,case when e14=0 then '' else dbo.getcomma(e14,0)end e14,
case when e15=0 then '' else dbo.getcomma(e15,0)end e15,case when e16=0 then '' else dbo.getcomma(e16,0)end e16,
case when e17=0 then '' else dbo.getcomma(e17,0)end e17,case when e18=0 then '' else dbo.getcomma(e18,0)end e18,
case when e19=0 then '' else dbo.getcomma(e19,0)end e19,
case when f01=0 then '' else dbo.getcomma(f01,0)end f01,case when f02=0 then '' else dbo.getcomma(f02,0)end f02,
case when f03=0 then '' else dbo.getcomma(f03,0)end f03,case when f04=0 then '' else dbo.getcomma(f04,0)end f04,
case when f05=0 then '' else dbo.getcomma(f05,0)end f05,case when f06=0 then '' else dbo.getcomma(f06,0)end f06,
case when f07=0 then '' else dbo.getcomma(f07,0)end f07,case when f08=0 then '' else dbo.getcomma(f08,0)end f08,
case when f09=0 then '' else dbo.getcomma(f09,0)end f09,case when f10=0 then '' else dbo.getcomma(f10,0)end f10,
case when f11=0 then '' else dbo.getcomma(f11,0)end f11,case when f12=0 then '' else dbo.getcomma(f12,0)end f12,
case when f13=0 then '' else dbo.getcomma(f13,0)end f13,case when f14=0 then '' else dbo.getcomma(f14,0)end f14,
case when f15=0 then '' else dbo.getcomma(f15,0)end f15,case when f16=0 then '' else dbo.getcomma(f16,0)end f16,
case when f17=0 then '' else dbo.getcomma(f17,0)end f17,case when f18=0 then '' else dbo.getcomma(f18,0)end f18,
case when f19=0 then '' else dbo.getcomma(f19,0)end f19,
case when h01=0 then '' else dbo.getcomma(h01,0)end h01,case when h02=0 then '' else dbo.getcomma(h02,0)end h02,
case when h03=0 then '' else dbo.getcomma(h03,0)end h03,case when h04=0 then '' else dbo.getcomma(h04,0)end h04,
case when h05=0 then '' else dbo.getcomma(h05,0)end h05,case when h06=0 then '' else dbo.getcomma(h06,0)end h06,
case when h07=0 then '' else dbo.getcomma(h07,0)end h07,case when h08=0 then '' else dbo.getcomma(h08,0)end h08,
case when h09=0 then '' else dbo.getcomma(h09,0)end h09,case when h10=0 then '' else dbo.getcomma(h10,0)end h10,
case when h11=0 then '' else dbo.getcomma(h11,0)end h11,case when h12=0 then '' else dbo.getcomma(h12,0)end h12,
case when h13=0 then '' else dbo.getcomma(h13,0)end h13,case when h14=0 then '' else dbo.getcomma(h14,0)end h14,
case when h15=0 then '' else dbo.getcomma(h15,0)end h15,case when h16=0 then '' else dbo.getcomma(h16,0)end h16,
case when h17=0 then '' else dbo.getcomma(h17,0)end h17,case when h18=0 then '' else dbo.getcomma(h18,0)end h18,
case when h19=0 then '' else dbo.getcomma(h19,0)end h19,
case when i01=0 then '' else dbo.getcomma(i01,0)end i01,case when i02=0 then '' else dbo.getcomma(i02,0)end i02,
case when i03=0 then '' else dbo.getcomma(i03,0)end i03,case when i04=0 then '' else dbo.getcomma(i04,0)end i04,
case when i05=0 then '' else dbo.getcomma(i05,0)end i05,case when i06=0 then '' else dbo.getcomma(i06,0)end i06,
case when i07=0 then '' else dbo.getcomma(i07,0)end i07,case when i08=0 then '' else dbo.getcomma(i08,0)end i08,
case when i09=0 then '' else dbo.getcomma(i09,0)end i09,case when i10=0 then '' else dbo.getcomma(i10,0)end i10,
case when i11=0 then '' else dbo.getcomma(i11,0)end i11,case when i12=0 then '' else dbo.getcomma(i12,0)end i12,
case when i13=0 then '' else dbo.getcomma(i13,0)end i13,case when i14=0 then '' else dbo.getcomma(i14,0)end i14,
case when i15=0 then '' else dbo.getcomma(i15,0)end i15,case when i16=0 then '' else dbo.getcomma(i16,0)end i16,
case when i17=0 then '' else dbo.getcomma(i17,0)end i17,case when i18=0 then '' else dbo.getcomma(i18,0)end i18,
case when i19=0 then '' else dbo.getcomma(i19,0)end i19,
case when j01=0 then '' else dbo.getcomma(j01,0)end j01,case when j02=0 then '' else dbo.getcomma(j02,0)end j02,
case when j03=0 then '' else dbo.getcomma(j03,0)end j03,case when j04=0 then '' else dbo.getcomma(j04,0)end j04,
case when j05=0 then '' else dbo.getcomma(j05,0)end j05,case when j06=0 then '' else dbo.getcomma(j06,0)end j06,
case when j07=0 then '' else dbo.getcomma(j07,0)end j07,case when j08=0 then '' else dbo.getcomma(j08,0)end j08,
case when j09=0 then '' else dbo.getcomma(j09,0)end j09,case when j10=0 then '' else dbo.getcomma(j10,0)end j10,
case when j11=0 then '' else dbo.getcomma(j11,0)end j11,case when j12=0 then '' else dbo.getcomma(j12,0)end j12,
case when j13=0 then '' else dbo.getcomma(j13,0)end j13,case when j14=0 then '' else dbo.getcomma(j14,0)end j14,
case when j15=0 then '' else dbo.getcomma(j15,0)end j15,case when j16=0 then '' else dbo.getcomma(j16,0)end j16,
case when j17=0 then '' else dbo.getcomma(j17,0)end j17,case when j18=0 then '' else dbo.getcomma(j18,0)end j18,
case when j19=0 then '' else dbo.getcomma(j19,0)end j19,
case when k01=0 then '' else dbo.getcomma(k01,0)end k01,case when k02=0 then '' else dbo.getcomma(k02,0)end k02,
case when k03=0 then '' else dbo.getcomma(k03,0)end k03,case when k04=0 then '' else dbo.getcomma(k04,0)end k04,
case when k05=0 then '' else dbo.getcomma(k05,0)end k05,case when k06=0 then '' else dbo.getcomma(k06,0)end k06,
case when k07=0 then '' else dbo.getcomma(k07,0)end k07,case when k08=0 then '' else dbo.getcomma(k08,0)end k08,
case when k09=0 then '' else dbo.getcomma(k09,0)end k09,case when k10=0 then '' else dbo.getcomma(k10,0)end k10,
case when k11=0 then '' else dbo.getcomma(k11,0)end k11,case when k12=0 then '' else dbo.getcomma(k12,0)end k12,
case when k13=0 then '' else dbo.getcomma(k13,0)end k13,case when k14=0 then '' else dbo.getcomma(k14,0)end k14,
case when k15=0 then '' else dbo.getcomma(k15,0)end k15,case when k16=0 then '' else dbo.getcomma(k16,0)end k16,
case when k17=0 then '' else dbo.getcomma(k17,0)end k17,case when k18=0 then '' else dbo.getcomma(k18,0)end k18,
case when k19=0 then '' else dbo.getcomma(k19,0)end k19,
case when l01=0 then '' else dbo.getcomma(l01,0)end l01,case when l02=0 then '' else dbo.getcomma(l02,0)end l02,
case when l03=0 then '' else dbo.getcomma(l03,0)end l03,case when l04=0 then '' else dbo.getcomma(l04,0)end l04,
case when l05=0 then '' else dbo.getcomma(l05,0)end l05,case when l06=0 then '' else dbo.getcomma(l06,0)end l06,
case when l07=0 then '' else dbo.getcomma(l07,0)end l07,case when l08=0 then '' else dbo.getcomma(l08,0)end l08,
case when l09=0 then '' else dbo.getcomma(l09,0)end l09,case when l10=0 then '' else dbo.getcomma(l10,0)end l10,
case when l11=0 then '' else dbo.getcomma(l11,0)end l11,case when l12=0 then '' else dbo.getcomma(l12,0)end l12,
case when l13=0 then '' else dbo.getcomma(l13,0)end l13,case when l14=0 then '' else dbo.getcomma(l14,0)end l14,
case when l15=0 then '' else dbo.getcomma(l15,0)end l15,case when l16=0 then '' else dbo.getcomma(l16,0)end l16,
case when l17=0 then '' else dbo.getcomma(l17,0)end l17,case when l18=0 then '' else dbo.getcomma(l18,0)end l18,
case when l19=0 then '' else dbo.getcomma(l19,0)end l19,
case when m01=0 then '' else dbo.getcomma(m01,0)end m01,case when m02=0 then '' else dbo.getcomma(m02,0)end m02,
case when m03=0 then '' else dbo.getcomma(m03,0)end m03,case when m04=0 then '' else dbo.getcomma(m04,0)end m04,
case when m05=0 then '' else dbo.getcomma(m05,0)end m05,case when m06=0 then '' else dbo.getcomma(m06,0)end m06,
case when m07=0 then '' else dbo.getcomma(m07,0)end m07,case when m08=0 then '' else dbo.getcomma(m08,0)end m08,
case when m09=0 then '' else dbo.getcomma(m09,0)end m09,case when m10=0 then '' else dbo.getcomma(m10,0)end m10,
case when m11=0 then '' else dbo.getcomma(m11,0)end m11,case when m12=0 then '' else dbo.getcomma(m12,0)end m12,
case when m13=0 then '' else dbo.getcomma(m13,0)end m13,case when m14=0 then '' else dbo.getcomma(m14,0)end m14,
case when m15=0 then '' else dbo.getcomma(m15,0)end m15,case when m16=0 then '' else dbo.getcomma(m16,0)end m16,
case when m17=0 then '' else dbo.getcomma(m17,0)end m17,case when m18=0 then '' else dbo.getcomma(m18,0)end m18,
case when m19=0 then '' else dbo.getcomma(m19,0)end m19,
case when n01=0 then '' else dbo.getcomma(n01,0)end n01,case when n02=0 then '' else dbo.getcomma(n02,0)end n02,
case when n03=0 then '' else dbo.getcomma(n03,0)end n03,case when n04=0 then '' else dbo.getcomma(n04,0)end n04,
case when n05=0 then '' else dbo.getcomma(n05,0)end n05,case when n06=0 then '' else dbo.getcomma(n06,0)end n06,
case when n07=0 then '' else dbo.getcomma(n07,0)end n07,case when n08=0 then '' else dbo.getcomma(n08,0)end n08,
case when n09=0 then '' else dbo.getcomma(n09,0)end n09,case when n10=0 then '' else dbo.getcomma(n10,0)end n10,
case when n11=0 then '' else dbo.getcomma(n11,0)end n11,case when n12=0 then '' else dbo.getcomma(n12,0)end n12,
case when n13=0 then '' else dbo.getcomma(n13,0)end n13,case when n14=0 then '' else dbo.getcomma(n14,0)end n14,
case when n15=0 then '' else dbo.getcomma(n15,0)end n15,case when n16=0 then '' else dbo.getcomma(n16,0)end n16,
case when n17=0 then '' else dbo.getcomma(n17,0)end n17,case when n18=0 then '' else dbo.getcomma(n18,0)end n18,
case when n19=0 then '' else dbo.getcomma(n19,0)end n19,
case when o01=0 then '' else dbo.getcomma(o01,0)end o01,case when o02=0 then '' else dbo.getcomma(o02,0)end o02,
case when o03=0 then '' else dbo.getcomma(o03,0)end o03,case when o04=0 then '' else dbo.getcomma(o04,0)end o04,
case when o05=0 then '' else dbo.getcomma(o05,0)end o05,case when o06=0 then '' else dbo.getcomma(o06,0)end o06,
case when o07=0 then '' else dbo.getcomma(o07,0)end o07,case when o08=0 then '' else dbo.getcomma(o08,0)end o08,
case when o09=0 then '' else dbo.getcomma(o09,0)end o09,case when o10=0 then '' else dbo.getcomma(o10,0)end o10,
case when o11=0 then '' else dbo.getcomma(o11,0)end o11,case when o12=0 then '' else dbo.getcomma(o12,0)end o12,
case when o13=0 then '' else dbo.getcomma(o13,0)end o13,case when o14=0 then '' else dbo.getcomma(o14,0)end o14,
case when o15=0 then '' else dbo.getcomma(o15,0)end o15,case when o16=0 then '' else dbo.getcomma(o16,0)end o16,
case when o17=0 then '' else dbo.getcomma(o17,0)end o17,case when o18=0 then '' else dbo.getcomma(o18,0)end o18,
case when o19=0 then '' else dbo.getcomma(o19,0)end o19,
case when p01=0 then '' else dbo.getcomma(p01,0)end p01,case when p02=0 then '' else dbo.getcomma(p02,0)end p02,
case when p03=0 then '' else dbo.getcomma(p03,0)end p03,case when p04=0 then '' else dbo.getcomma(p04,0)end p04,
case when p05=0 then '' else dbo.getcomma(p05,0)end p05,case when p06=0 then '' else dbo.getcomma(p06,0)end p06,
case when p07=0 then '' else dbo.getcomma(p07,0)end p07,case when p08=0 then '' else dbo.getcomma(p08,0)end p08,
case when p09=0 then '' else dbo.getcomma(p09,0)end p09,case when p10=0 then '' else dbo.getcomma(p10,0)end p10,
case when p11=0 then '' else dbo.getcomma(p11,0)end p11,case when p12=0 then '' else dbo.getcomma(p12,0)end p12,
case when p13=0 then '' else dbo.getcomma(p13,0)end p13,case when p14=0 then '' else dbo.getcomma(p14,0)end p14,
case when p15=0 then '' else dbo.getcomma(p15,0)end p15,case when p16=0 then '' else dbo.getcomma(p16,0)end p16,
case when p17=0 then '' else dbo.getcomma(p17,0)end p17,case when p18=0 then '' else dbo.getcomma(p18,0)end p18,
case when p19=0 then '' else dbo.getcomma(p19,0)end p19,
case when q01=0 then '' else dbo.getcomma(q01,0)end q01,case when q02=0 then '' else dbo.getcomma(q02,0)end q02,
case when q03=0 then '' else dbo.getcomma(q03,0)end q03,case when q04=0 then '' else dbo.getcomma(q04,0)end q04,
case when q05=0 then '' else dbo.getcomma(q05,0)end q05,case when q06=0 then '' else dbo.getcomma(q06,0)end q06,
case when q07=0 then '' else dbo.getcomma(q07,0)end q07,case when q08=0 then '' else dbo.getcomma(q08,0)end q08,
case when q09=0 then '' else dbo.getcomma(q09,0)end q09,case when q10=0 then '' else dbo.getcomma(q10,0)end q10,
case when q11=0 then '' else dbo.getcomma(q11,0)end q11,case when q12=0 then '' else dbo.getcomma(q12,0)end q12,
case when q13=0 then '' else dbo.getcomma(q13,0)end q13,case when q14=0 then '' else dbo.getcomma(q14,0)end q14,
case when q15=0 then '' else dbo.getcomma(q15,0)end q15,case when q16=0 then '' else dbo.getcomma(q16,0)end q16,
case when q17=0 then '' else dbo.getcomma(q17,0)end q17,case when q18=0 then '' else dbo.getcomma(q18,0)end q18,
case when q19=0 then '' else dbo.getcomma(q19,0)end q19,
case when r01=0 then '' else dbo.getcomma(r01,0)end r01,case when r02=0 then '' else dbo.getcomma(r02,0)end r02,
case when r03=0 then '' else dbo.getcomma(r03,0)end r03,case when r04=0 then '' else dbo.getcomma(r04,0)end r04,
case when r05=0 then '' else dbo.getcomma(r05,0)end r05,case when r06=0 then '' else dbo.getcomma(r06,0)end r06,
case when r07=0 then '' else dbo.getcomma(r07,0)end r07,case when r08=0 then '' else dbo.getcomma(r08,0)end r08,
case when r09=0 then '' else dbo.getcomma(r09,0)end r09,case when r10=0 then '' else dbo.getcomma(r10,0)end r10,
case when r11=0 then '' else dbo.getcomma(r11,0)end r11,case when r12=0 then '' else dbo.getcomma(r12,0)end r12,
case when r13=0 then '' else dbo.getcomma(r13,0)end r13,case when r14=0 then '' else dbo.getcomma(r14,0)end r14,
case when r15=0 then '' else dbo.getcomma(r15,0)end r15,case when r16=0 then '' else dbo.getcomma(r16,0)end r16,
case when r17=0 then '' else dbo.getcomma(r17,0)end r17,case when r18=0 then '' else dbo.getcomma(r18,0)end r18,
case when r19=0 then '' else dbo.getcomma(r19,0)end r19,
case when s01=0 then '' else dbo.getcomma(s01,0)end s01,case when s02=0 then '' else dbo.getcomma(s02,0)end s02,
case when s03=0 then '' else dbo.getcomma(s03,0)end s03,case when s04=0 then '' else dbo.getcomma(s04,0)end s04,
case when s05=0 then '' else dbo.getcomma(s05,0)end s05,case when s06=0 then '' else dbo.getcomma(s06,0)end s06,
case when s07=0 then '' else dbo.getcomma(s07,0)end s07,case when s08=0 then '' else dbo.getcomma(s08,0)end s08,
case when s09=0 then '' else dbo.getcomma(s09,0)end s09,case when s10=0 then '' else dbo.getcomma(s10,0)end s10,
case when s11=0 then '' else dbo.getcomma(s11,0)end s11,case when s12=0 then '' else dbo.getcomma(s12,0)end s12,
case when s13=0 then '' else dbo.getcomma(s13,0)end s13,case when s14=0 then '' else dbo.getcomma(s14,0)end s14,
case when s15=0 then '' else dbo.getcomma(s15,0)end s15,case when s16=0 then '' else dbo.getcomma(s16,0)end s16,
case when s17=0 then '' else dbo.getcomma(s17,0)end s17,case when s18=0 then '' else dbo.getcomma(s18,0)end s18,
case when s19=0 then '' else dbo.getcomma(s19,0)end s19,
case when t01=0 then '' else dbo.getcomma(t01,0)end t01,case when t02=0 then '' else dbo.getcomma(t02,0)end t02,
case when t03=0 then '' else dbo.getcomma(t03,0)end t03,case when t04=0 then '' else dbo.getcomma(t04,0)end t04,
case when t05=0 then '' else dbo.getcomma(t05,0)end t05,case when t06=0 then '' else dbo.getcomma(t06,0)end t06,
case when t07=0 then '' else dbo.getcomma(t07,0)end t07,case when t08=0 then '' else dbo.getcomma(t08,0)end t08,
case when t09=0 then '' else dbo.getcomma(t09,0)end t09,case when t10=0 then '' else dbo.getcomma(t10,0)end t10,
case when t11=0 then '' else dbo.getcomma(t11,0)end t11,case when t12=0 then '' else dbo.getcomma(t12,0)end t12,
case when t13=0 then '' else dbo.getcomma(t13,0)end t13,case when t14=0 then '' else dbo.getcomma(t14,0)end t14,
case when t15=0 then '' else dbo.getcomma(t15,0)end t15,case when t16=0 then '' else dbo.getcomma(t16,0)end t16,
case when t17=0 then '' else dbo.getcomma(t17,0)end t17,case when t18=0 then '' else dbo.getcomma(t18,0)end t18,
case when t19=0 then '' else dbo.getcomma(t19,0)end t19,
case when u01=0 then '' else dbo.getcomma(u01,0)end u01,case when u02=0 then '' else dbo.getcomma(u02,0)end u02,
case when u03=0 then '' else dbo.getcomma(u03,0)end u03,case when u04=0 then '' else dbo.getcomma(u04,0)end u04,
case when u05=0 then '' else dbo.getcomma(u05,0)end u05,case when u06=0 then '' else dbo.getcomma(u06,0)end u06,
case when u07=0 then '' else dbo.getcomma(u07,0)end u07,case when u08=0 then '' else dbo.getcomma(u08,0)end u08,
case when u09=0 then '' else dbo.getcomma(u09,0)end u09,case when u10=0 then '' else dbo.getcomma(u10,0)end u10,
case when u11=0 then '' else dbo.getcomma(u11,0)end u11,case when u12=0 then '' else dbo.getcomma(u12,0)end u12,
case when u13=0 then '' else dbo.getcomma(u13,0)end u13,case when u14=0 then '' else dbo.getcomma(u14,0)end u14,
case when u15=0 then '' else dbo.getcomma(u15,0)end u15,case when u16=0 then '' else dbo.getcomma(u16,0)end u16,
case when u17=0 then '' else dbo.getcomma(u17,0)end u17,case when u18=0 then '' else dbo.getcomma(u18,0)end u18,
case when u19=0 then '' else dbo.getcomma(u19,0)end u19,
case when v01=0 then '' else dbo.getcomma(v01,0)end v01,case when v02=0 then '' else dbo.getcomma(v02,0)end v02,
case when v03=0 then '' else dbo.getcomma(v03,0)end v03,case when v04=0 then '' else dbo.getcomma(v04,0)end v04,
case when v05=0 then '' else dbo.getcomma(v05,0)end v05,case when v06=0 then '' else dbo.getcomma(v06,0)end v06,
case when v07=0 then '' else dbo.getcomma(v07,0)end v07,case when v08=0 then '' else dbo.getcomma(v08,0)end v08,
case when v09=0 then '' else dbo.getcomma(v09,0)end v09,case when v10=0 then '' else dbo.getcomma(v10,0)end v10,
case when v11=0 then '' else dbo.getcomma(v11,0)end v11,case when v12=0 then '' else dbo.getcomma(v12,0)end v12,
case when v13=0 then '' else dbo.getcomma(v13,0)end v13,case when v14=0 then '' else dbo.getcomma(v14,0)end v14,
case when v15=0 then '' else dbo.getcomma(v15,0)end v15,case when v16=0 then '' else dbo.getcomma(v16,0)end v16,
case when v17=0 then '' else dbo.getcomma(v17,0)end v17,case when v18=0 then '' else dbo.getcomma(v18,0)end v18,
case when v19=0 then '' else dbo.getcomma(v19,0)end v19,
case when w01=0 then '' else dbo.getcomma(w01,0)end w01,case when w02=0 then '' else dbo.getcomma(w02,0)end w02,
case when w03=0 then '' else dbo.getcomma(w03,0)end w03,case when w04=0 then '' else dbo.getcomma(w04,0)end w04,
case when w05=0 then '' else dbo.getcomma(w05,0)end w05,case when w06=0 then '' else dbo.getcomma(w06,0)end w06,
case when w07=0 then '' else dbo.getcomma(w07,0)end w07,case when w08=0 then '' else dbo.getcomma(w08,0)end w08,
case when w09=0 then '' else dbo.getcomma(w09,0)end w09,case when w10=0 then '' else dbo.getcomma(w10,0)end w10,
case when w11=0 then '' else dbo.getcomma(w11,0)end w11,case when w12=0 then '' else dbo.getcomma(w12,0)end w12,
case when w13=0 then '' else dbo.getcomma(w13,0)end w13,case when w14=0 then '' else dbo.getcomma(w14,0)end w14,
case when w15=0 then '' else dbo.getcomma(w15,0)end w15,case when w16=0 then '' else dbo.getcomma(w16,0)end w16,
case when w17=0 then '' else dbo.getcomma(w17,0)end w17,case when w18=0 then '' else dbo.getcomma(w18,0)end w18,
case when w19=0 then '' else dbo.getcomma(w19,0)end w19,
case when x01=0 then '' else dbo.getcomma(x01,0)end x01,case when x02=0 then '' else dbo.getcomma(x02,0)end x02,
case when x03=0 then '' else dbo.getcomma(x03,0)end x03,case when x04=0 then '' else dbo.getcomma(x04,0)end x04,
case when x05=0 then '' else dbo.getcomma(x05,0)end x05,case when x06=0 then '' else dbo.getcomma(x06,0)end x06,
case when x07=0 then '' else dbo.getcomma(x07,0)end x07,case when x08=0 then '' else dbo.getcomma(x08,0)end x08,
case when x09=0 then '' else dbo.getcomma(x09,0)end x09,case when x10=0 then '' else dbo.getcomma(x10,0)end x10,
case when x11=0 then '' else dbo.getcomma(x11,0)end x11,case when x12=0 then '' else dbo.getcomma(x12,0)end x12,
case when x13=0 then '' else dbo.getcomma(x13,0)end x13,case when x14=0 then '' else dbo.getcomma(x14,0)end x14,
case when x15=0 then '' else dbo.getcomma(x15,0)end x15,case when x16=0 then '' else dbo.getcomma(x16,0)end x16,
case when x17=0 then '' else dbo.getcomma(x17,0)end x17,case when x18=0 then '' else dbo.getcomma(x18,0)end x18,
case when x19=0 then '' else dbo.getcomma(x19,0)end x19,
case when y01=0 then '' else dbo.getcomma(y01,0)end y01,case when y02=0 then '' else dbo.getcomma(y02,0)end y02,
case when y03=0 then '' else dbo.getcomma(y03,0)end y03,case when y04=0 then '' else dbo.getcomma(y04,0)end y04,
case when y05=0 then '' else dbo.getcomma(y05,0)end y05,case when y06=0 then '' else dbo.getcomma(y06,0)end y06,
case when y07=0 then '' else dbo.getcomma(y07,0)end y07,case when y08=0 then '' else dbo.getcomma(y08,0)end y08,
case when y09=0 then '' else dbo.getcomma(y09,0)end y09,case when y10=0 then '' else dbo.getcomma(y10,0)end y10,
case when y11=0 then '' else dbo.getcomma(y11,0)end y11,case when y12=0 then '' else dbo.getcomma(y12,0)end y12,
case when y13=0 then '' else dbo.getcomma(y13,0)end y13,case when y14=0 then '' else dbo.getcomma(y14,0)end y14,
case when y15=0 then '' else dbo.getcomma(y15,0)end y15,case when y16=0 then '' else dbo.getcomma(y16,0)end y16,
case when y17=0 then '' else dbo.getcomma(y17,0)end y17,case when y18=0 then '' else dbo.getcomma(y18,0)end y18,
case when y19=0 then '' else dbo.getcomma(y19,0)end y19,
case when z01=0 then '' else dbo.getcomma(z01,0)end z01,case when z02=0 then '' else dbo.getcomma(z02,0)end z02,
case when z03=0 then '' else dbo.getcomma(z03,0)end z03,case when z04=0 then '' else dbo.getcomma(z04,0)end z04,
case when z05=0 then '' else dbo.getcomma(z05,0)end z05,case when z06=0 then '' else dbo.getcomma(z06,0)end z06,
case when z07=0 then '' else dbo.getcomma(z07,0)end z07,case when z08=0 then '' else dbo.getcomma(z08,0)end z08,
case when z09=0 then '' else dbo.getcomma(z09,0)end z09,case when z10=0 then '' else dbo.getcomma(z10,0)end z10,
case when z11=0 then '' else dbo.getcomma(z11,0)end z11,case when z12=0 then '' else dbo.getcomma(z12,0)end z12,
case when z13=0 then '' else dbo.getcomma(z13,0)end z13,case when z14=0 then '' else dbo.getcomma(z14,0)end z14,
case when z15=0 then '' else dbo.getcomma(z15,0)end z15,case when z16=0 then '' else dbo.getcomma(z16,0)end z16,
case when z17=0 then '' else dbo.getcomma(z17,0)end z17,case when z18=0 then '' else dbo.getcomma(z18,0)end z18,
case when z19=0 then '' else dbo.getcomma(z19,0)end z19,
case when aa01=0 then '' else dbo.getcomma(aa01,0)end aa01,case when aa02=0 then '' else dbo.getcomma(aa02,0)end aa02,
case when aa03=0 then '' else dbo.getcomma(aa03,0)end aa03,case when aa04=0 then '' else dbo.getcomma(aa04,0)end aa04,
case when aa05=0 then '' else dbo.getcomma(aa05,0)end aa05,case when aa06=0 then '' else dbo.getcomma(aa06,0)end aa06,
case when aa07=0 then '' else dbo.getcomma(aa07,0)end aa07,case when aa08=0 then '' else dbo.getcomma(aa08,0)end aa08,
case when aa09=0 then '' else dbo.getcomma(aa09,0)end aa09,case when aa10=0 then '' else dbo.getcomma(aa10,0)end aa10,
case when aa11=0 then '' else dbo.getcomma(aa11,0)end aa11,case when aa12=0 then '' else dbo.getcomma(aa12,0)end aa12,
case when aa13=0 then '' else dbo.getcomma(aa13,0)end aa13,case when aa14=0 then '' else dbo.getcomma(aa14,0)end aa14,
case when aa15=0 then '' else dbo.getcomma(aa15,0)end aa15,case when aa16=0 then '' else dbo.getcomma(aa16,0)end aa16,
case when aa17=0 then '' else dbo.getcomma(aa17,0)end aa17,case when aa18=0 then '' else dbo.getcomma(aa18,0)end aa18,
case when aa19=0 then '' else dbo.getcomma(aa19,0)end aa19,
case when ab01=0 then '' else dbo.getcomma(ab01,0)end ab01,case when ab02=0 then '' else dbo.getcomma(ab02,0)end ab02,
case when ab03=0 then '' else dbo.getcomma(ab03,0)end ab03,case when ab04=0 then '' else dbo.getcomma(ab04,0)end ab04,
case when ab05=0 then '' else dbo.getcomma(ab05,0)end ab05,case when ab06=0 then '' else dbo.getcomma(ab06,0)end ab06,
case when ab07=0 then '' else dbo.getcomma(ab07,0)end ab07,case when ab08=0 then '' else dbo.getcomma(ab08,0)end ab08,
case when ab09=0 then '' else dbo.getcomma(ab09,0)end ab09,case when ab10=0 then '' else dbo.getcomma(ab10,0)end ab10,
case when ab11=0 then '' else dbo.getcomma(ab11,0)end ab11,case when ab12=0 then '' else dbo.getcomma(ab12,0)end ab12,
case when ab13=0 then '' else dbo.getcomma(ab13,0)end ab13,case when ab14=0 then '' else dbo.getcomma(ab14,0)end ab14,
case when ab15=0 then '' else dbo.getcomma(ab15,0)end ab15,case when ab16=0 then '' else dbo.getcomma(ab16,0)end ab16,
case when ab17=0 then '' else dbo.getcomma(ab17,0)end ab17,case when ab18=0 then '' else dbo.getcomma(ab18,0)end ab18,
case when ab19=0 then '' else dbo.getcomma(ab19,0)end ab19,
case when ac01=0 then '' else dbo.getcomma(ac01,0)end ac01,case when ac02=0 then '' else dbo.getcomma(ac02,0)end ac02,
case when ac03=0 then '' else dbo.getcomma(ac03,0)end ac03,case when ac04=0 then '' else dbo.getcomma(ac04,0)end ac04,
case when ac05=0 then '' else dbo.getcomma(ac05,0)end ac05,case when ac06=0 then '' else dbo.getcomma(ac06,0)end ac06,
case when ac07=0 then '' else dbo.getcomma(ac07,0)end ac07,case when ac08=0 then '' else dbo.getcomma(ac08,0)end ac08,
case when ac09=0 then '' else dbo.getcomma(ac09,0)end ac09,case when ac10=0 then '' else dbo.getcomma(ac10,0)end ac10,
case when ac11=0 then '' else dbo.getcomma(ac11,0)end ac11,case when ac12=0 then '' else dbo.getcomma(ac12,0)end ac12,
case when ac13=0 then '' else dbo.getcomma(ac13,0)end ac13,case when ac14=0 then '' else dbo.getcomma(ac14,0)end ac14,
case when ac15=0 then '' else dbo.getcomma(ac15,0)end ac15,case when ac16=0 then '' else dbo.getcomma(ac16,0)end ac16,
case when ac17=0 then '' else dbo.getcomma(ac17,0)end ac17,case when ac18=0 then '' else dbo.getcomma(ac18,0)end ac18,
case when ac19=0 then '' else dbo.getcomma(ac19,0)end ac19,
case when ad01=0 then '' else dbo.getcomma(ad01,0)end ad01,case when ad02=0 then '' else dbo.getcomma(ad02,0)end ad02,
case when ad03=0 then '' else dbo.getcomma(ad03,0)end ad03,case when ad04=0 then '' else dbo.getcomma(ad04,0)end ad04,
case when ad05=0 then '' else dbo.getcomma(ad05,0)end ad05,case when ad06=0 then '' else dbo.getcomma(ad06,0)end ad06,
case when ad07=0 then '' else dbo.getcomma(ad07,0)end ad07,case when ad08=0 then '' else dbo.getcomma(ad08,0)end ad08,
case when ad09=0 then '' else dbo.getcomma(ad09,0)end ad09,case when ad10=0 then '' else dbo.getcomma(ad10,0)end ad10,
case when ad11=0 then '' else dbo.getcomma(ad11,0)end ad11,case when ad12=0 then '' else dbo.getcomma(ad12,0)end ad12,
case when ad13=0 then '' else dbo.getcomma(ad13,0)end ad13,case when ad14=0 then '' else dbo.getcomma(ad14,0)end ad14,
case when ad15=0 then '' else dbo.getcomma(ad15,0)end ad15,case when ad16=0 then '' else dbo.getcomma(ad16,0)end ad16,
case when ad17=0 then '' else dbo.getcomma(ad17,0)end ad17,case when ad18=0 then '' else dbo.getcomma(ad18,0)end ad18,
case when ad19=0 then '' else dbo.getcomma(ad19,0)end ad19,
case when ae01=0 then '' else dbo.getcomma(ae01,0)end ae01,case when ae02=0 then '' else dbo.getcomma(ae02,0)end ae02,
case when ae03=0 then '' else dbo.getcomma(ae03,0)end ae03,case when ae04=0 then '' else dbo.getcomma(ae04,0)end ae04,
case when ae05=0 then '' else dbo.getcomma(ae05,0)end ae05,case when ae06=0 then '' else dbo.getcomma(ae06,0)end ae06,
case when ae07=0 then '' else dbo.getcomma(ae07,0)end ae07,case when ae08=0 then '' else dbo.getcomma(ae08,0)end ae08,
case when ae09=0 then '' else dbo.getcomma(ae09,0)end ae09,case when ae10=0 then '' else dbo.getcomma(ae10,0)end ae10,
case when ae11=0 then '' else dbo.getcomma(ae11,0)end ae11,case when ae12=0 then '' else dbo.getcomma(ae12,0)end ae12,
case when ae13=0 then '' else dbo.getcomma(ae13,0)end ae13,case when ae14=0 then '' else dbo.getcomma(ae14,0)end ae14,
case when ae15=0 then '' else dbo.getcomma(ae15,0)end ae15,case when ae16=0 then '' else dbo.getcomma(ae16,0)end ae16,
case when ae17=0 then '' else dbo.getcomma(ae17,0)end ae17,case when ae18=0 then '' else dbo.getcomma(ae18,0)end ae18,
case when ae19=0 then '' else dbo.getcomma(ae19,0)end ae19,
case when af01=0 then '' else dbo.getcomma(af01,0)end af01,case when af02=0 then '' else dbo.getcomma(af02,0)end af02,
case when af03=0 then '' else dbo.getcomma(af03,0)end af03,case when af04=0 then '' else dbo.getcomma(af04,0)end af04,
case when af05=0 then '' else dbo.getcomma(af05,0)end af05,case when af06=0 then '' else dbo.getcomma(af06,0)end af06,
case when af07=0 then '' else dbo.getcomma(af07,0)end af07,case when af08=0 then '' else dbo.getcomma(af08,0)end af08,
case when af09=0 then '' else dbo.getcomma(af09,0)end af09,case when af10=0 then '' else dbo.getcomma(af10,0)end af10,
case when af11=0 then '' else dbo.getcomma(af11,0)end af11,case when af12=0 then '' else dbo.getcomma(af12,0)end af12,
case when af13=0 then '' else dbo.getcomma(af13,0)end af13,case when af14=0 then '' else dbo.getcomma(af14,0)end af14,
case when af15=0 then '' else dbo.getcomma(af15,0)end af15,case when af16=0 then '' else dbo.getcomma(af16,0)end af16,
case when af17=0 then '' else dbo.getcomma(af17,0)end af17,case when af18=0 then '' else dbo.getcomma(af18,0)end af18,
case when af19=0 then '' else dbo.getcomma(af19,0)end af19,
case when ag01=0 then '' else dbo.getcomma(ag01,0)end ag01,case when ag02=0 then '' else dbo.getcomma(ag02,0)end ag02,
case when ag03=0 then '' else dbo.getcomma(ag03,0)end ag03,case when ag04=0 then '' else dbo.getcomma(ag04,0)end ag04,
case when ag05=0 then '' else dbo.getcomma(ag05,0)end ag05,case when ag06=0 then '' else dbo.getcomma(ag06,0)end ag06,
case when ag07=0 then '' else dbo.getcomma(ag07,0)end ag07,case when ag08=0 then '' else dbo.getcomma(ag08,0)end ag08,
case when ag09=0 then '' else dbo.getcomma(ag09,0)end ag09,case when ag10=0 then '' else dbo.getcomma(ag10,0)end ag10,
case when ag11=0 then '' else dbo.getcomma(ag11,0)end ag11,case when ag12=0 then '' else dbo.getcomma(ag12,0)end ag12,
case when ag13=0 then '' else dbo.getcomma(ag13,0)end ag13,case when ag14=0 then '' else dbo.getcomma(ag14,0)end ag14,
case when ag15=0 then '' else dbo.getcomma(ag15,0)end ag15,case when ag16=0 then '' else dbo.getcomma(ag16,0)end ag16,
case when ag17=0 then '' else dbo.getcomma(ag17,0)end ag17,case when ag18=0 then '' else dbo.getcomma(ag18,0)end ag18,
case when ag19=0 then '' else dbo.getcomma(ag19,0)end ag19,
case when ah01=0 then '' else dbo.getcomma(ah01,0)end ah01,case when ah02=0 then '' else dbo.getcomma(ah02,0)end ah02,
case when ah03=0 then '' else dbo.getcomma(ah03,0)end ah03,case when ah04=0 then '' else dbo.getcomma(ah04,0)end ah04,
case when ah05=0 then '' else dbo.getcomma(ah05,0)end ah05,case when ah06=0 then '' else dbo.getcomma(ah06,0)end ah06,
case when ah07=0 then '' else dbo.getcomma(ah07,0)end ah07,case when ah08=0 then '' else dbo.getcomma(ah08,0)end ah08,
case when ah09=0 then '' else dbo.getcomma(ah09,0)end ah09,case when ah10=0 then '' else dbo.getcomma(ah10,0)end ah10,
case when ah11=0 then '' else dbo.getcomma(ah11,0)end ah11,case when ah12=0 then '' else dbo.getcomma(ah12,0)end ah12,
case when ah13=0 then '' else dbo.getcomma(ah13,0)end ah13,case when ah14=0 then '' else dbo.getcomma(ah14,0)end ah14,
case when ah15=0 then '' else dbo.getcomma(ah15,0)end ah15,case when ah16=0 then '' else dbo.getcomma(ah16,0)end ah16,
case when ah17=0 then '' else dbo.getcomma(ah17,0)end ah17,case when ah18=0 then '' else dbo.getcomma(ah18,0)end ah18,
case when ah19=0 then '' else dbo.getcomma(ah19,0)end ah19,
case when ai01=0 then '' else dbo.getcomma(ai01,0)end ai01,case when ai02=0 then '' else dbo.getcomma(ai02,0)end ai02,
case when ai03=0 then '' else dbo.getcomma(ai03,0)end ai03,case when ai04=0 then '' else dbo.getcomma(ai04,0)end ai04,
case when ai05=0 then '' else dbo.getcomma(ai05,0)end ai05,case when ai06=0 then '' else dbo.getcomma(ai06,0)end ai06,
case when ai07=0 then '' else dbo.getcomma(ai07,0)end ai07,case when ai08=0 then '' else dbo.getcomma(ai08,0)end ai08,
case when ai09=0 then '' else dbo.getcomma(ai09,0)end ai09,case when ai10=0 then '' else dbo.getcomma(ai10,0)end ai10,
case when ai11=0 then '' else dbo.getcomma(ai11,0)end ai11,case when ai12=0 then '' else dbo.getcomma(ai12,0)end ai12,
case when ai13=0 then '' else dbo.getcomma(ai13,0)end ai13,case when ai14=0 then '' else dbo.getcomma(ai14,0)end ai14,
case when ai15=0 then '' else dbo.getcomma(ai15,0)end ai15,case when ai16=0 then '' else dbo.getcomma(ai16,0)end ai16,
case when ai17=0 then '' else dbo.getcomma(ai17,0)end ai17,case when ai18=0 then '' else dbo.getcomma(ai18,0)end ai18,
case when ai19=0 then '' else dbo.getcomma(ai19,0)end ai19,
case when aj01=0 then '' else dbo.getcomma(aj01,0)end aj01,case when aj02=0 then '' else dbo.getcomma(aj02,0)end aj02,
case when aj03=0 then '' else dbo.getcomma(aj03,0)end aj03,case when aj04=0 then '' else dbo.getcomma(aj04,0)end aj04,
case when aj05=0 then '' else dbo.getcomma(aj05,0)end aj05,case when aj06=0 then '' else dbo.getcomma(aj06,0)end aj06,
case when aj07=0 then '' else dbo.getcomma(aj07,0)end aj07,case when aj08=0 then '' else dbo.getcomma(aj08,0)end aj08,
case when aj09=0 then '' else dbo.getcomma(aj09,0)end aj09,case when aj10=0 then '' else dbo.getcomma(aj10,0)end aj10,
case when aj11=0 then '' else dbo.getcomma(aj11,0)end aj11,case when aj12=0 then '' else dbo.getcomma(aj12,0)end aj12,
case when aj13=0 then '' else dbo.getcomma(aj13,0)end aj13,case when aj14=0 then '' else dbo.getcomma(aj14,0)end aj14,
case when aj15=0 then '' else dbo.getcomma(aj15,0)end aj15,case when aj16=0 then '' else dbo.getcomma(aj16,0)end aj16,
case when aj17=0 then '' else dbo.getcomma(aj17,0)end aj17,case when aj18=0 then '' else dbo.getcomma(aj18,0)end aj18,
case when aj19=0 then '' else dbo.getcomma(aj19,0)end aj19,
case when al01=0 then '' else dbo.getcomma(al01,0)end al01,case when al02=0 then '' else dbo.getcomma(al02,0)end al02,
case when al03=0 then '' else dbo.getcomma(al03,0)end al03,case when al04=0 then '' else dbo.getcomma(al04,0)end al04,
case when al05=0 then '' else dbo.getcomma(al05,0)end al05,case when al06=0 then '' else dbo.getcomma(al06,0)end al06,
case when al07=0 then '' else dbo.getcomma(al07,0)end al07,case when al08=0 then '' else dbo.getcomma(al08,0)end al08,
case when al09=0 then '' else dbo.getcomma(al09,0)end al09,case when al10=0 then '' else dbo.getcomma(al10,0)end al10,
case when al11=0 then '' else dbo.getcomma(al11,0)end al11,case when al12=0 then '' else dbo.getcomma(al12,0)end al12,
case when al13=0 then '' else dbo.getcomma(al13,0)end al13,case when al14=0 then '' else dbo.getcomma(al14,0)end al14,
case when al15=0 then '' else dbo.getcomma(al15,0)end al15,case when al16=0 then '' else dbo.getcomma(al16,0)end al16,
case when al17=0 then '' else dbo.getcomma(al17,0)end al17,case when al18=0 then '' else dbo.getcomma(al18,0)end al18,
case when al19=0 then '' else dbo.getcomma(al19,0)end al19,
case when am01=0 then '' else dbo.getcomma(am01,0)end am01,case when am02=0 then '' else dbo.getcomma(am02,0)end am02,
case when am03=0 then '' else dbo.getcomma(am03,0)end am03,case when am04=0 then '' else dbo.getcomma(am04,0)end am04,
case when am05=0 then '' else dbo.getcomma(am05,0)end am05,case when am06=0 then '' else dbo.getcomma(am06,0)end am06,
case when am07=0 then '' else dbo.getcomma(am07,0)end am07,case when am08=0 then '' else dbo.getcomma(am08,0)end am08,
case when am09=0 then '' else dbo.getcomma(am09,0)end am09,case when am10=0 then '' else dbo.getcomma(am10,0)end am10,
case when am11=0 then '' else dbo.getcomma(am11,0)end am11,case when am12=0 then '' else dbo.getcomma(am12,0)end am12,
case when am13=0 then '' else dbo.getcomma(am13,0)end am13,case when am14=0 then '' else dbo.getcomma(am14,0)end am14,
case when am15=0 then '' else dbo.getcomma(am15,0)end am15,case when am16=0 then '' else dbo.getcomma(am16,0)end am16,
case when am17=0 then '' else dbo.getcomma(am17,0)end am17,case when am18=0 then '' else dbo.getcomma(am18,0)end am18,
case when am19=0 then '' else dbo.getcomma(am19,0)end am19
,acc1,acc2,acc3,acc4,acc5,acc6,acc7,acc8,accc1,accc2,accc3,accc4,accc5,accc6,accc7,accc8,accc9,accc10,accc11,accc12,accc13
from #tmp3 a left join #tmp2 b on a.pageno=b.pageno
order by b.pageno

IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	set @cmd = 'drop table #tmp'
	EXECUTE sp_executesql @cmd
END
IF OBJECT_ID('tempdb..#tmp2')is not null
BEGIN
	set @cmd = 'drop table #tmp2'
	EXECUTE sp_executesql @cmd
END
IF OBJECT_ID('tempdb..#tmp3')is not null
BEGIN
	set @cmd = 'drop table #tmp3'
	EXECUTE sp_executesql @cmd
END
;
--------------------------------------------------------------------------------------------------------------------------------------------
z_trans_yp03:--z_trans_yp03
declare @t_mon nvarchar(10)
declare @t_bdriverno nvarchar(20)
declare @t_edriverno nvarchar(20)
	
set @t_mon = case when '#non'=[2] then '' else [2] end
set @t_bdriverno = case when '#non'=[3] then '' else [3] end
set @t_edriverno = case when '#non'=[4] then char(255) else [4] end
declare @tmp table(
		gno nvarchar(1),
		yy nvarchar(10),
		mm nvarchar(10),
		driverno nvarchar(100),
		driver nvarchar(100),
		datea nvarchar(30),
		comp nvarchar(100),
		product nvarchar(100),
		straddr nvarchar(max),
		endaddr nvarchar(max),
		total float,
		total2 float
)
	
insert @tmp
select '0',SUBSTRING(a.trandate,1,3),SUBSTRING(a.trandate,5,2),a.driverno,a.driver,SUBSTRING(a.datea,5,5),b.comp,b.product,b.straddr,b.endaddr,b.total,b.total2
from tran106 a
left join trans106 b on a.datea = b.datea and a.driverno = b.driverno
where left(a.trandate,6)=@t_mon and a.driverno between @t_bdriverno and @t_edriverno

insert @tmp (gno,driverno,total,total2)
select '1',driverno,SUM(total) ,SUM(total2) 
from @tmp
group by driverno

insert @tmp(gno,driverno)
select '2',driverno
from @tmp
group by driverno

select gno,yy,mm,driverno,driver,datea,comp,product,straddr,endaddr,dbo.getComma(total,0)total,dbo.getComma(total2,0)total2 from @tmp order by driverno,gno;