z_ssschg1:--z_ssschg1
	SET QUOTED_IDENTIFIER OFF
	declare @t_bmon nvarchar(10)
	declare @t_emon nvarchar(10)
	declare @t_bsss nvarchar(100)
	declare @t_esss nvarchar(100)
	
	set @t_bmon = case when '#non'='#non' then '' else '#non' end
	set @t_emon = case when '#non'='#non' then char(255) else '#non' end
	set @t_bsss = case when '#non'='#non' then '' else '#non' end
	set @t_esss = case when '#non'='#non' then char(255) else '#non' end
	
	declare @tmp table(
		gno nvarchar(1),
		namea nvarchar(100),
		sex nvarchar(10),
		noa nvarchar(100),
		indate nvarchar(10),
		typea nvarchar(10),
		datea nvarchar(10),
		bfdatea nvarchar(10),
		reason nvarchar(max),
		handover nvarchar(max),
		memo nvarchar(max),
		
		opart nvarchar(100),
		ojob nvarchar(100),
		oclass5 nvarchar(10),
		omoney float,
		obo_admin float,
		obo_traffic float,
		obo_special float,
		obo_oth float,
		obo_full float,
		omeals float,
		
		apart nvarchar(100),
		ajob nvarchar(100),
		aclass5 nvarchar(10),
		amoney float,
		abo_admin float,
		abo_traffic float,
		abo_special float,
		abo_oth float,
		abo_full float,
		ameals float
		
	)
	
	insert @tmp
	select '0',b.namea,case when b.sex=1 then '男' else '女' end,b.noa,b.indate,a.typea,a.datea,a.bfdatea,a.reason,a.handover,a.memo
			,a.opart,a.ojob,a.oclass5,c.money,c.bo_admin,c.bo_traffic,c.bo_special,c.bo_oth,c.bo_full
			,c.meals,a.apart,a.ajob,a.aclass5,d.money,d.bo_admin,d.bo_traffic,d.bo_special,d.bo_oth,d.bo_full,d.meals
	from ssschg a left join sss b on a.noa=b.noa
	outer apply (select top 1 * from saladjust where jobno=a.ojobno order by datea desc)c
	outer apply (select * from saladjust where datea=a.bfdatea and noa=b.noa and jobno=a.ajobno)d
	where (Left(a.datea,7) between @t_bmon and @t_emon)
	and (b.noa between @t_bsss and @t_esss) 
	
	select 
	dbo.getComma(omoney,0)omoney,
	dbo.getComma(obo_admin,0)obo_admin,
	dbo.getComma(obo_traffic,0)obo_traffic,
	dbo.getComma(obo_special,0)obo_special,
	dbo.getComma(obo_oth,0)obo_oth,
	dbo.getComma(obo_full,0)obo_full,
	dbo.getComma(omeals,0)omeals,
	dbo.getComma(amoney,0)amoney,
	dbo.getComma(abo_admin,0)abo_admin,
	dbo.getComma(abo_traffic,0)abo_traffic,
	dbo.getComma(abo_special,0)abo_special,
	dbo.getComma(abo_oth,0)abo_oth,
	dbo.getComma(abo_full,0)abo_full,
	dbo.getComma(ameals,0)ameals,
	* 
	from @tmp order by noa,gno
	;